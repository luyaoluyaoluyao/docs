---
title: "通话REST 服务操作"
parent: "微观流动活动"
---

{{% alert type="info" %}}
这种活动只能用于微流，而不能用于纳米流。
{{% /报警 %}}

## 1 导言

通话REST 服务行动可以调用REST 端点。 您可以指定应如何处理REST 调用响应的位置。

## 2 概况

![](attachments/19203256/19399080.png)

### 2.1 地点

**位置** 属性定义了要调用的 REST 端点。 需要使用字符串模板输入位置。 字符串模板应产生一个有效的 URL 字符串。 参数可以通过在括号之间写入数字来使用 (例如， `{1}`)。 对于模板中的每个参数，您可以使用 [微流程表达式](expressions) 来指定其值，并产生一个字符串值。 为了逃避打开的大棒(`演变为`), 应该使用双打开大棒(`{□`).

**HTTP 方法** 属性定义了调用REST 端点时要使用的 HTTP 方法。 可能的值是：GET、POST、PUT、PATCH、DELETE、HEAD和OPTIONS。

### 2.2 超时

设置 **在请求时使用超时** 到 **是的，** 可以指定通话REST 活动应该等待多长时间才能响应REST 端点。 如果REST 端点在 **超时秒数(s)**之后还没有响应， 将发生异常，微流将回滚或转到您的自定义错误处理器。

### 2.3 代理配置

{{% alert type="info" %}}

此功能是在7.15.0版本中引入的。

{{% /报警 %}}

在几乎所有情况下，您都可以忽略此设置。 **使用工程设置** 是一个好的默认值。

如果想要，您可以配置是否为请求使用代理人。 这些选择是：

* **使用项目设置** - 使用项目一级定义的任何设置 (默认)
* **覆盖** - 此操作的项目级别设置
* **没有代理** - 即使在项目一级配置了代理，也不使用代理服务器

当您选择 **覆盖**，您可以动态地配置是否使用代理人。 然后您为代理提供主机、 端口、 用户名和密码设置。

## 3 HTTP 头

![](attachments/19203256/19399093.png)

### 3.1 身份验证

**使用 HTTP 身份验证** 复选框定义了是否应使用基本身份验证。

**用户名** 属性定义了将用于认证HTTP的用户名。 用户名需要使用 [微流程表达式](expressions) 输入. 微流程表达式应产生一个字符串。

**密码** 属性定义了将用于通过 HTTP 身份验证的密码。 密码需要使用 [表达式](expressions) 输入. 微流程表达式应产生一个字符串。

### 3.2 自定义 HTTP 头

这些信头已添加到 HTTP 请求头中。 每个自定义头都是一个键值和值(微流程表达式)。

## 4 个请求

![](attachments/19203256/19399114.png)

下面的部分描述了下拉菜单中生成请求的选项。 只能为 HTTP 方法 POST、PUT、PATCH和OPTIONS 生成请求。

### 4.1 整个请求的出口映射

此选项允许您为请求的正文使用单个 [导出映射](export-mappings)。

#### 4.1.1 映射

选择您想要应用的映射。

#### 4.1.2 参数类型

如果 [导出映射](export-mappings) 需要输入，此字段显示输入的类型。

#### 4.1.3 参数

如果 [导出映射](export-mappings) 需要输入，您可以选择一个正确类型的变量。

#### 4.1.4 内容类型

如果 [导出映射](export-mappings) 基于消息定义，它可以导出XML 和 JSON 。 选择您想要的输出类型。 **Content-Type 标题** 未设置为默认值。 要设置它，请使用 **自定义 HTTP 头** 标签。

### 4.2 整个请求的二进制文件

此选项允许您发送二进制数据(例如，文件文档的内容)。

### 4.3 自定义请求模板

此选项允许您使用字符串模板生成请求。 模板以纯文本定义请求的结构。 参数可以通过在括号之间写入数字来使用 (例如， `{1}`)。 对于模板中的每个参数，您可以使用 [微流程表达式](expressions) 来指定其值，并产生一个字符串值。 为了逃避打开的大棒(`演变为`), 应该使用双打开大棒(`{□`).

## 5 答复

![](attachments/19203256/19399084.png)

### 5.1 反应处理

这些是下拉菜单中处理响应的选项：

* **应用导入映射** - 如果响应是 JSON 或 XML， 它可以使用 [导入映射](import-mappings) 直接转换为对象。 您可以在此选择的字段在 [导入映射操作中描述](import-mapping-action)
* **存储在 HTTP 响应** - 任何成功的 HTTP 响应都可以直接存储在 [HtpResponse](http-request-and-response-entities#http-response) 对象中， 并且 [$latestHttpResponse](#latesthttpresponse) 变量也被更新
* **存储在文件变量** - 如果响应是二进制内容 (例如) a PDF, 它可以存储在实体中 - 该实体应该继承 `System的遗产。 文件`
* **存储在字符串** - 如果响应是字符串(例如，CSV)，它可以直接存储在字符串变量中
* **不要存储变量** - 当调用没有返回任何有用的情况下使用此选项

### 5.2 产出

**类型** 字段定义输出变量的类型。

**名称** 字段定义了将保持操作结果的变量名称。

### 5.3 错误处理

当HTTP响应状态代码不成功时(例如重定向 [3xx] 或错误[4xx 和 5xx])，本节适用。

当选择 **存储消息主体在 $latestHttpResponse 变量** 选项时， `$latestHttpResponse/Content` 将与响应正文一起设置。 它可能包含服务器提供的一些有用信息（例如，为什么拒绝认证）。

### 5.4 $latestHttpResponse 变量<a name="latesthttpresponse"></a>

`$latestHttpResponse` 变量是 [HttpResponse](http-request-and-response-entities#http-response) 类型。 它在通话REST 活动后可用。

然而，它的 `内容` 属性在大多数情况下将留空，以尽量减少内存使用。

当出现以下场景之一时，此属性将被填充：

* **响应处理** 是 **存储在 HTTP 响应** 中，呼叫成功
* **信息正文在 $latestHttpResponse 变量** 选项中存储在 **错误处理** 部分被选中，呼叫失败

此变量可以从范围内的任何微流动作中访问。
