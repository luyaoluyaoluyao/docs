---
title: "版本控制"
#description: "Set a description with a maximum of 140 characters; this should describe what the goal of the document is, and it can be different from the document introduction; this is optional, and it can be removed"
tags:
  - "版本控制"
  - "应用生命周期管理"
  - "提交"
  - "协作"
---

## 1 导言

版本控制允许您以两种方式管理您的应用开发：

* 首先，它允许您储存您的模型及其所有资源 ([*提交*](#commit)) 当前的版本。 你给它一个标识符，以便你能够再次获得这个版本并与其他团队成员分享它。
* 第二， 它允许在多行 [*开发线*](#development-line)上进行工作，以便可以同时处理几个不同的功能。 然后这些开发线可以是 [**](#merge) 一起返回，以便您的 *主行* 包含所有已经单独完成的功能。

Mendix 版本控制建立在 [Apache Subversion](https://subversion.apache.org/) 的顶端，Subversion 用户将熟悉这些概念。 Mendix 简化了 Subversion 命令，并将其编译到Modeler and Developer Portal。

{{% alert type="warning" %}}

本文所述的 Web Modeler 程序适用于Mendix 版本 7.23.3 及以上的协作工作。

如果您的项目有 Mendix 7.23.2 或以下版本，您不能将您的更改同步到 Web Moderr 。 您仍然可以在 Web Modeler 中打开您的项目。 但Web Modeler将自动升级到最新版本的7.23补丁。
{{% /报警 %}}

## 2 概念 {#concepts}

### 2.1 团队服务器

团队服务器是所有已提交的 Mendix 应用程序的存储地点。 如果您对应用程序进行了修订，它将存储在团队服务器。

要提交到团队服务器，您需要在允许您编辑应用程序的项目中发挥作用。

### 2.2 仓库

在 *团队服务器* 中，每个应用程序都存储在一个仓库中。 This repository contains all the *committed revisions* for the *branches* of the app.

### 2.3 修订

一个版本是您的应用程序的一次性版本，存储在 *团队服务器* 中。

您的应用程序的每个版本都有一个独特的数字来识别它，并使您能够在未来找到它。 在以下两种情况下从 *桌面模型* 创建了一个新的版本：

* 应用程序已承诺到存储库
* 一个桌面模型工作副本已从 Web Moderr 工作副本更新

### 2.4 工作副本

一个工作副本是您的应用程序的版本，目前正在模型中使用。 对于桌面模型，应用的每个开发线都有一个工作副本。 这种模型是在当地每台进行开发工作的计算机上进行的。

对于Web Modeler来说，在 *云中有一个额外的工作副本。* 一次只有一个开发者可以编辑它。

### 2.5 合并{#merge}

合并是指对应用程序进行一个 *版本* 并应用在不同版本中产生的差异。 欲了解更多信息，请参阅第4.3节 [合并分支](#merging-branches)。

如果任何差异无法应用，那么就会有 *冲突*。

### 2.6 冲突

当两个版本的应用无法自动合并时，发生冲突。 当同一文档在桌面Modeler工作副本中被更改并且提交了 *版本* 并且这些更改无法调节时，就会发生这种情况。 这方面的例子如下：

* 小部件的属性在修订版和工作副本中被更改，但在不同的设置
* 一个文档在修订版中被移动或删除，但在工作版中被以不同的方式更改。

冲突发生时， 开发人员必须进行干预，决定如何解决它，然后才能将其作为一个新的版本提交到团队服务器。

### 2.7 更新

更新是在桌面模式中调用的动作， 从团队服务器仓库获取当前 *开发行* 的最新版本，并将差异合并到当前的工作副本。

如果此开发行启用 Web Moderr 这个过程首先确保Web Moderr 工作副本作为一个新的版本存储。

### 2.8 提交{#commit}

提交是指在桌面模式中调用的动作， 将您所有的更改发送到 *存储库* 并做一个新的 *版本*。

如果此开发行启用 Web Moderr 此流程首先确保Web Modeler工作副本作为新版本存储并合并到桌面模式的工作副本中。 如果没有冲突，然后将更改发送到仓库进行新的修订。

### 2.9 开发线{#development-line}

在开发线开发应用，进行了一系列相关的更改。 有两种类型的开发行： *主行* 和 *分支行。*

#### 2.9.1 主线

主线是应用的初始开发线，并且通常保持为将部署到生产环境的版本。 简单的应用和不需要高度合作的应用可能只能有一条主线。

#### 2.9.2 分线 {#branch-line}

支线是一种使一套独立的改变脱离主线的方法。

更多关于如何使用分支行的信息，参见第4节 [分支](#branches)。

### 2.10 Web Modelr 已启用

您可以为开发行启用Web Modeler。 这意味着开发者可以通过 Web Modeler 对应用进行更改，并与团队共享更改。 所有更改都将链接到选定的分支，并作为对该分支的修订提交。 对其他开发线的更改将无法在 Web Modeler 中获得。

Web Moderr 不能用于开发应用，如果它没有用于任何开发线。

对于通过开发者门户创建的应用模板，新应用的主行将启用 Web Moderr 。

### 2.11 标签

标签是除了 *修订版* 数字之外识别一个提交的方法。 它是由开发者指定的，有四个部分：

* 主要：用于识别重要的新功能、新的用户界面或其他重要更改
* 次要功能：用于识别新功能以增加应用的主要功能
* 补丁：用于在先前发布的应用程序中标识 *修复*
* 版本：自动添加，是提交的版本号

## 单一分支的版本控制进程

下图显示了两个开发者可以如何在 *Web Modelr 上工作，启用了应用程序的* 开发线。 有一个开发者在 Web Modeler 中工作，一个在桌面模型中工作。 它们都是在同一发展线上开展工作（例如主线）。

![](attachments/version-control/image1.png)

### 3.1 仅在网页建模中工作

开发者在 Web Modeler 上运行应用程序。 他们从状态1中的应用程序开始，这可以是一个新的应用程序或应用程序的修订。 对存放在云端的网页模型的工作副本不断作了修改。

![](attachments/version-control/image2.png)

### 3.2 仅在桌面模式下工作

另一个(或相同的)开发者首次在桌面模式下打开应用程序。 从 Web Moderr 工作副本的当前状态，在团队服务器上创建了一个新的版本(状态 2) 。 它作为桌面模式的工作副本下载到本地机器。 Web Modeler暂时被锁定，以使Web Moder工作副本在复制时具有稳定性。

开发者在桌面模式下在应用的本地工作副本上工作。 在这个场景中，Web Modeler没有完成任何工作。

开发者可以随时将此操作提交给团队服务器仓库进行新的修订(状态 3)。 此版本已复制到 Web Moderr 工作副本，使用 Web Moderr 的开发者将自动获得更改。

![](attachments/version-control/image3.png)

### 3.3 两种模型的工作

两位开发者同时在同一应用的相同的 *开发行* 上工作。 一个正在使用桌面模型，另一个正在使用Web Model。 两种模式的更改都存储在各自的工作副本中：桌面模式的本地机器和网页模式的云端。

![](attachments/version-control/image4.png)

### 3.4 更新桌面模型工作副本

使用桌面模式的开发者想要包含开发者使用 Web Modeler 所做的更改。 他们选择更新其工作副本。

Web Moderr 工作副本中的所有更改都会在团队服务器上（状态4）被纳入一个新的版本。 此版本已合并到桌面建模工作副本。 正在更新桌面建模工作副本， Web Modeler暂时被锁定，以使Web Modeler工作副本在复制时具有稳定性。

{{% alert type="info" %}}
如果其他开发者已经对此分支做了更改，这也会从他们使用桌面模式的其他开发者那里接收更改。
{{% /报警 %}}

如果存在冲突， 使用桌面模式的开发者必须先解决它们，然后才能将更改提交给团队服务器仓库。

![](attachments/version-control/image5.png)

### 3.5 对团队服务器仓库的提交更改

使用桌面模式的开发者想要向团队服务器提交一个新的版本。 这将使开发者能够使用 Web Modeler 或使用桌面模型的其他开发者， 查看开发者所做的更改并与之合作。 这还意味着可以把修订工作部署到云端。

开发者选择要提交的内容，然后发生以下事情：

* Web Modeler 已被临时锁定
* Web Moderr 工作副本作为修订版提交(还原点-状态 5)
* 刚刚创建的版本 (状态 5) 已合并到桌面模型工作副本

如果没有合并 *冲突*, 更新的桌面建模工作副本作为新的版本(状态6)提交，Web 建模更新到新的版本并解锁。

如果发生冲突，使用桌面模型的开发者将需要解决这些问题。 Web Modeler将被解锁，而不会从桌面模式收到任何更改，同时他们也会这样做。 使用桌面模型的开发者需要再次提交。 和进程从开始(Web Moderr 已被锁定，可以从Web Moderr 工作副本中进行新的修订)。

![](attachments/version-control/image6.png)

## 4 个分支{#branches}

有了更复杂的应用，你可能想要以更复杂的方式管理你的代码。 例如， 您可能想要与当前安装的应用程序版本分开开发新功能，以便您可以修复任何bug，而无需释放所有新功能。

这是使用 *分支行* 完成的。

### 4.1 主线

所有应用都是沿主行开发的(也称为 *trunk*)。 这里你所有的开发都沿着一条线进行，所有的修改都建立在先前的修订版本的基础上：

![](attachments/version-control/image7.png)

第3节“单一分支的版本控制程序”中所述的版本控制程序就是这种情况。

最初，使用 Web Moderr 的开发人员只能访问网络Moderr 所启用的开发线。 然而，他们可以通过开发者使用桌面模型切换到另一条开发线。

### 4.2 支线线

当您添加分支行时，您将拿走现有的 *版本* 的副本，并且单独使用该副本。 对一个分支机构所作的更改不影响任何其他分支机构。

在 Mendix 中， *版本库* 中的每个版本都有一个唯一的版本号。 这意味着沿任何选定分支行给版本号的版本号可能不是连续的。

![](attachments/version-control/image8.png)

### 4.3 合并分支{#merging-branches}

您可能有一个分支线，这个分支线将继续独立，永远不需要与任何其他开发线合并。 例如，您可以为您的应用程序的特定版本创建一个分支，并且只能使用它来修复该版本中的bug。

另一方面，你可能想要将一个分支的功能添加到另一个开发线。 有两个案例这样做：

* 你在分支行开发新功能，想要将它们纳入你的主要开发行
* 你想要利用在另一个分支上生成的错误修复

您可以将分支行的特定版本合并到您当前的 *工作副本*。 例如，如果您正在更新到第6修订版的主行， 你可以 *从另一行合并* 修订版5到你的工作副本。 然后您可以提交结果来创建版本 7。 如果您想要合并几个不同的承付更改和一个分支， 您将需要选择包含所有更改的修订范围。

![](attachments/version-control/image9.png)

如同第3节“单一分支的版本控制程序”中的例子，在合并过程中可能会发生冲突。 并且这些都必须先解决才能对您的应用进行修改。

注意 *错误* 可以由 *合并* 进程引入，即使在合并过程中没有发现冲突。 错误是模型中标记的不一致之处，将防止应用程序被部署。 它们可能导致无法部署的修订，因此在您完成合并后检查错误是很重要的。

## 5 个此类别中的主要文档

* [在桌面模型中使用版本控制](using-version-control-in-the-dm)
* [团队服务器](团队服务器)
