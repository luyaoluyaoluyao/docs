---
title: "微型流动"
parent: "应用逻辑："
menu_order: 10
description: "显示可用于微流的所有元素的概述。"
---

## 1 导言

{{% alert type="info" %}}

此页是可以在微流程中使用的所有元素的概述。 对于微流程本身的属性，请参阅 [微流程属性](microflow)。

{{% /报警 %}}

Microflow允许您表达应用程序的逻辑。 微流可以执行创建和更新对象、显示页面和选择等操作。 这是一种直观的表达传统的文本程序代码的方式。

## 2 个键盘支持

微流程编辑器提供键盘支持导航和操作微流。 下表显示可以使用的密钥。

| 关键字               | 效果                         |
| ----------------- | -------------------------- |
| 箭头键               | 在箭头方向选择附近的元素(活动、事件、循环或参数)。 |
| 输入                | 编辑选中元素的属性。                 |
| F2                | 重命名所选元素引入的变量。              |
| Shift+F2 或只是开始输入  | 编辑选中元素的标题。                 |
| Ctrl+箭头键          | 向箭头方向移动选中的元素。              |
| Tab               | 如果选择循环，循环中的第一个元素将被选中。      |
| Shift+Tab         | 如果选择循环中的元素，循环本身将被选中。       |
| 首页                | 选择开始事件。                    |
| 结束                | 循环到结束事件。                   |
| 上下文菜单键或 Shift-F10 | 打开当前选中元素的上下文菜单。            |

## 3 注释

微流的图形缩写基于 [业务流程模型和符号](https://en.wikipedia.org/wiki/Business_Process_Model_and_Notation) (BPMN)。 BPMN是在工作流程中绘制业务流程的标准化图形标记。

微流由元素组成。 下面是所有要素的分类概述。 使用了以下类别：

*   [事件](#events) 代表一个循环中微流程和特殊操作的起始点和终点。
*   [流动](#flows) 形成元素之间的连接。
*   [网关](#gateways) 处理选择和重新合并不同的路径。
*   [活动](#activities) 是在微流程中执行的动作。
*   [伪影](#artifacts) 为微流提供输入并允许发表评论。
*   [错误处理程序](#errorhandlers) 可以设置在活动、网关或循环上来定义如何处理错误。

## 4 事件<a name="events"></a>

事件代表微流和特殊操作在循环中的起始点和终点。

| 图形                                                   | 名称                     | 描述                                                       |
| ---------------------------------------------------- | ---------------------- | -------------------------------------------------------- |
| [![](attachments/819203/917902.png)](start-event)    | [开始事件](start-event)    | 开始活动是微流的起点。 微流只能有一个起始事件。                                 |
| [![](attachments/819203/918113.png)](end-event)      | [结束事件](end-event)      | 终端事件定义了微流将停止的位置。 根据微流的返回类型，在某些情况下必须指定一个值。 可以有多个结束事件。     |
| ![](attachments/16713739/16843951.png)               | [错误事件](error-event)    | 一个错误事件定义了微流停止并抛出之前发生的错误的位置。 如果您调用微流，您可能想知道微流中是否发生任何错误。   |
| [![](attachments/819203/918115.png)](continue-event) | [继续事件](continue-event) | 持续事件用于停止当前循环的迭代并继续下一次迭代。 请注意，继续事件只能在 [循环](loop) 中使用。     |
| [![](attachments/819203/918026.png)](break-event)    | [中断事件](break-event)    | 休息活动用于停止对对象列表的迭代，继续循环后的其余流程。 请注意，中断事件只能在 [循环](loop) 中使用。 |

## 5 流动<a name="flows"></a>

流程形成元素之间的连接。

| 图形                                                    | 名称                      | 描述                                       |
| ----------------------------------------------------- | ----------------------- | ---------------------------------------- |
| [![](attachments/819203/917883.png)](sequence-flow)   | [序列流](sequence-flow)    | 序列流程是指连接事件、活动、分割和合并的箭头。 它们共同确定了微流中的执行顺序。 |
| [![](attachments/819203/917688.png)](annotation-flow) | [批注流程](annotation-flow) | 关联是可用来将注解连接到另一个元素的连接。                    |

## 6 网关<a name="gateways"></a>

网关处理选择和重新合并不同路径...

| 图形                                                    | 名称                      | 描述                                |
| ----------------------------------------------------- | ----------------------- | --------------------------------- |
| [![](attachments/819203/917726.png)](exclusive-split) | [独家拆分](exclusive-split) | 唯一的分割是根据一项条件作出决定，并且只遵循一项外流流量中的一个。 |


**注意**: 微流中没有平行执行。 | | [![](attachments/819203/918122.png)](inheritance-split) | [继承分割](inheritance-split) | 继承分割是一个基于选定对象的 [专业化](entities) 做出选择的元素。 您可以使用 [投射对象](cast-object) 动作给专业化对象一个名称。 | | [![](attachments/819203/918116.png)|](merge) | [合并](merge) | 可以使用合并将多个序列流合并为一个。 如果在微流中作出选择，然后需要做一些共同的工作。 您可以合并两个(或更多)路径。 |

## 7 活动<a name="activities"></a>

活动是在微观过程中采取的行动。

| 图形                                       | 名称       | 描述                                                                                     |
| ---------------------------------------- | -------- | -------------------------------------------------------------------------------------- |
| [![](attachments/819203/918096.png)](活动) | [活动](活动) | 活动可以用于在微流中执行特定的动作。                                                                     |
| [![](attachments/819203/917804.png)](循环) | [循环](循环) | 循环活动用于在对象列表上迭代。 对于每个对象，循环活动内的流程都会被执行。 循环活动可以包含微流中使用的所有元素，但启动和停止事件除外。 流程始于第一个元素，没有输入流量。 |

## 8 个神器<a name="artifacts"></a>

伪影提供了微流的输入，并允许发表评论。

| 图形                                       | 名称       | 描述                          |
| ---------------------------------------- | -------- | --------------------------- |
| [![](attachments/819203/918019.png)](参数) | [参数](参数) | 参数是充当微流输入的数据。 参数填写在触发微流的地点。 |
| [![](attachments/819203/917689.png)](注释) | [批注](注释) | 注解是一个可以用来将注释放入微流程的元素。       |

## 9 变量使用

Moderr 可视化所选对象使用的变量。 它通过在蓝色背景上显示使用的变量来做到这一点。 相反，使用选定对象定义的变量的元素在绿色背景上用白色文本中的“用法”标记。

在下面的示例中，参数 **账户密码数据** 被高亮显示，因为它被用于选定的活动。 并且活动 **保存密码** 有一个用法标签，因为它使用了所选活动定义的变量。

![](attachments/16713739/16843950.png)

## 10 个错误

当微流发生错误时，对对象的所有更改都会回滚，微流被中止。 可选，您可以通过配置不同的错误处理设置来处理微流本身中的错误。 您甚至可以通过查看预定义的变量 `$latestError` 和 `$latestSoapFault` 查看错误的细节。

### 10.1 错误处理<a name="errorhandlers"></a>

一个错误处理程序可以设置在一个活动、网关或循环。 在一个活动或网关上，它为您提供了三个选项：

*   Rollback (default)
*   自定义回滚功能
*   自定义但不回滚。

对于后两个选项，您可以从方块中绘制额外的流程，并将此流程标记为错误处理流程。 当选择“自定义回滚”时，当发生错误时它会触发此路径，然后继续回滚。 “自定义无回滚”选项不会回滚对象。 当您选择一个流程作为错误处理程序后，它将显示在下面的图像中。

![](attachments/819203/918247.png)

在一个循环中，你会得到两个选项：

*   Rollback (default)
*   继续

继续选项意味着当发生错误时，循环将继续进行下一次迭代。 它将在循环的退出流程中以连续图标显示。

![](attachments/819203/918246.png)

### 10.2 检查错误

当微流中发生错误时，当发生错误时，产生了 Java 异常，其中含有发生错误的信息。 在自定义错误处理程序内(如在错误处理流程之后)， 您可以检查此 Java 异常的类型以及其他一些属性。 每个微流都包含两个预定义的错误变量， `$latestError` 和 `$latestSoapFault`。 `$latestError` 是实体系统错误的对象, `$latestSoapFault` 是实体系统的对象, 是系统错误的专业化.

在一个自定义错误处理程序中，错误发生后执行， `$latestError` 被设置为包含错误信息的对象。 如果错误是一个 SOAP 故障（因网络服务通话而发生的错误）， `$latestSoapFault` 设置为包含更多关于SOAP 错误的具体信息的对象。 否则， `$latestSoapFault` 是 `空的`。

{{% alert type="success" %}}

您可以通过检查 `$latestSoapFault` 为 `空的` 来确定一个错误是否为 SOAP 错误。

{{% /报警 %}}

下表显示System.Error 和 System.SoapFault的属性。

| 实体               | 属性        | 类型  | 描述               |
| ---------------- | --------- | --- | ---------------- |
| 系统错误             | ErrorType | 字符串 | 发生错误的 Java 异常类型。 |
| 系统错误             | 留言        | 字符串 | Java 异常的消息。      |
| 系统错误             | 堆栈跟踪      | 字符串 | Java 异常的堆栈。      |
| System.SoapFault | 代码        | 字符串 | SOAP 错误代码元素。     |
| System.SoapFault | 原因        | 字符串 | SOAP 错误的原因。      |
| System.SoapFault | 节点        | 字符串 | SOAP 错误的节点元素。    |
| System.SoapFault | 作用        | 字符串 | SOAP 的角色元素错误。    |
| System.SoapFault | 细节        | 字符串 | SOAP 错误的详细元素。    |

Click [here](http://www.w3.org/TR/soap12-part1/#soapfault) for more information on SOAP faults.

{{% alert type="warning" %}}

在应用实体访问权限的微流中，出于安全原因无法检查错误对象的属性。 您可以将错误对象传递给不应用实体访问权限并检查其属性的子流程。

{{% /报警 %}}

## 11 微流程调试

如果您想要看到微流执行时发生什么，您可以使用微流调试器。 看看下面的办法：

*   [调试微流](/howto7/monitoring-troubleshooting/debug-microflows)
*   [远程调试微流](/howto7/monitoring-troubleshooting/debug-microflows-remotely)
