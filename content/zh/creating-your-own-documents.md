---
title: "创建您自己的文档"
parent: "文档模板"
description: "此文档将让您深入了解如何使用 Mendix 创建文档。"
tags:
  - "文件"
  - "生成"
  - "单词"
  - "PDF"
  - "studio pro"
---

## 1 导言

您是否在想如何使用Mendix创建您自己的文档？ 这个引用将告诉你如何做！

使用 Mendix 可以不同方式生成文档。 在这里，您将从自己的应用程序中学习生成文档的基本要素。

在我们开始之前，我们建议您首先阅读以下两页：

* [文档模板](文档模板)
* [生成文档](generate-document)

## 2 知道您的文档

在您开始使用 Mendix 生成文档之前，最好是编写您想要生成的文档的草稿。 你可以在一张纸上草绘一些东西，或要求你的客户为你提供一个例子。 不管怎样，牢记你想要实现的目标都是好的。

使用您想要的文档，您可以选择一个生成文档的策略。 Mendix 提供了许多选项来使用户外文档模板功能制作文档。 但您可能发现Mendix 功能不足以生成您的文档。 不必担心. 使用 Mendix 生成文档的替代方式，见 [创建文档的替代方式](#Alternative)。

例如，我们的结论是，Mendix 功能已经足够了。 因此，让我们看看这如何用一个例子来运作。

## 3 商业案件

在此应用程序中，客户可以购买产品。 他们将通过创建订单和选择他们想要购买的产品来这样做。 能够向客户展示他们的订单概述， a PDF将被创建并作为确认电子邮件的附件发送给客户。 订单应显示客户详情、公司标志、产品价格和订单总价值。

## 正在生成带有Out-of-Box Mendix 功能的文档

### 4.1 域模型

此应用程序的域模型看起来像这样：

![](attachments/core/2018-02-28_16-37-25.png)

**客户** 持有地址信息和首选通信语言。 **命令** 拥有所有订单行的日期和总和。 **订单行** 实体有一个 **产品** 的客户特定价格。 因为您想要生成文档， **订单文档** 实体已被添加。 此实体继承自 **System.FileDocument** 实体。

{{% alert type="info" %}}
不要使用 **系统。 文件** 实体直接，因为您无法控制 **系统** 模块中的该部分的安全性。
{{% /报警 %}}

### 4.2 微流

现在，域模型已经设置，您准备为新的生成文档功能创建微流程。

创建一个新文件夹来组织所有订单文档创建相关源：

![](attachments/core/2018-02-28_17-02-05.png)

现在你需要一个微流程来处理文档的创建：

![](attachments/core/2018-02-28_17-04-03.png)

微流由当前的默认起始点和终点组成：

![](attachments/core/2018-02-28_16-30-18.png)

创建微流程后，决定您想要在文档中使用的信息。 让我们以订单作为输入。 稍后，您可以通过订单实例检索额外的数据。

{{% alert type="info" %}}
当您创建微流时，最佳做法是限制输入参数的数量以促进重新使用。
{{% /报警 %}}

以下是输入参数：

![](attachments/core/2018-02-28_16-32-33.png)

在下一步，您将创建一个新的订单文件。 此对象将存储实际文档。 设置 **订单** 对象和文档名称的引用：

![](attachments/core/2018-02-28_16-52-43.png)

现在你需要有一个 **语言** 对象。 在我们的情况下， **客户** 与首选的通信语言相关联。 在我们的微流程示例中，您先通过 **订单**检索 **客户** 然后从该语言中检索 **语言** **客户**：

![](attachments/core/2018-02-28_16-58-54.png)

下一步是使用 **生成文档** 活动。 在此活动中，您可以使用可用对象并选择文档模板来创建文档。 然而，文档模板尚不存在，所以您需要创建它并将它放置在您的文件夹中：

![](attachments/core/2018-02-28_17-06-53.png)

这是文档模板配置：

![](attachments/core/2018-03-01_13-03-55.png)

{{% alert type="info" %}}
基于您对所选模板的更改，参数将会更改。
{{% /报警 %}}

**生成文档** 已被添加：

![](attachments/core/2018-03-01_13-06-33.png)

在您配置文档模板的一般设置后，您不需要为 **NewOrderDocument** 单独提交。 此实体是通过文档模板活动自动提交的。

现在您已经设置 **生成文档** 配置，您可以配置模板本身。

{{% alert type="info" %}}
请确保设置文档模板中使用的实体及其属性的正确的实体访问权限。 读取访问权限是模板中显示的属性的必填项。 这里有一个 **客户** 实体被配置为 **阅读，写入** **用户** 模块角色：

![](attachments/core/2018-03-01_13-12-28.png)

{{% /报警 %}}

### 4.3 文件模板

在此示例中，以下文档模板可用：

![](attachments/core/2018-03-01_14-05-07.png)

在此文档模板中，您以包含订单详细信息的数据视图开始。 您可以从此订单中获取客户信息，并从订单行获取购买产品的信息。

数据视图使用表格、表格单元、标签、图片、行断和模板网格组成文档。

现在您已经创建了文档模板，您可以看到错误码头中存在错误：

![](attachments/core/2018-03-01_14-08-48.png)

要解决这个错误，请打开 **生成文档** 微流程活动。 当活动打开时，参数映射将被更新并分配到映射参数。

现在，您的 **生成文档** 配置应该看起来像这样：

![](attachments/core/2018-03-01_14-12-03.png)

文档模板已配置，微流程已准备就绪。 如果我们将此微流程称为子微流程，您可以在主微流程中添加下载活动。 这种微流可以做到以下几点：

* 调用子微流创建文档
* 检索创建的文档
* 下载文件

![](attachments/core/2018-03-01_14-21-38.png)

这是产生的文档：

![](attachments/how-to-create-your-own-documents/15_Result.png)

在此示例中，您通过 **实体 (路径)** 数据源检索了 **命令行** 信息。 这样做的另一种方法是使用微流程返回列表表述中的物体。 如果你这样做， 确保将正确的用户角色添加到文档模板内正在用作数据源微流的微流。

## 5 创建文件的替代方法 {#Alternative}

生成文档的另一种方式是通过 Java API，称为IText。 此 Java 库是免费使用的。

关于这种工作方式的更多信息，请参阅 [iText Developers](http://developers.itextpdf.com/developers-home)。
