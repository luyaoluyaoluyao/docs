---
title: "更新您的工作流定义"
parent: "工作流"
menu_order: 60
tags:
  - "工作流"
  - "工作流"
  - "版本"
  - "更新"
---

## 1 导言

工作流正在运行很长时间。 当工作流定义发生变化时，例如： 从工作流定义中添加或删除任务或活动，因此运行的工作流实例可能仍然存在。

任何时候都会部署一个新的工作流定义并启动运行时间，它会升级运行的工作流实例到现有的最新定义。 这意味着现有的工作流实例可以继续成功运行。 自那时起，这些实例将遵循最新的 Workflow 定义。

但在某些情况下，运行时间将无法升级运行的工作流程实例。

本文件更详细地描述了这两起案件。

## 2 成功升级到最新工作流定义

以下任何更改均被解释为没有冲突：

* 在当前工作流尚未执行的路径中添加活动
* 删除当前工作流正在执行的路径中的活动
* 当前工作流正在执行的路径中重新排序活动
* 活动或结果的改变性质：
* * 更改名称、标题和标题
  * 在 **调用微流** 活动中更改引用的微流，或在 **工作流调用中的引用工作流** 活动
  * 更改用户任务中的引用页面
  * 在用户任务中更改用户分配或用户分配选项
  * 更改用户任务的到期日期
* 在 **决策**中添加结果。 **调用微流程** 或 **用户任务** 活动
* 更改上下文实体、引用微流、引用页面或引用的工作流

## 3 次升级到最新工作流定义时冲突

当升级到最新的工作流定义时，运行时间检测到以下情况相互冲突：

* 当前工作流活动之一已经从最新的 **工作流定义** (e) 中删除。 。目前工作流实例正在等待的用户任务已从定义中全部删除)
* 在已经执行的路径中引入了一个并行路径
* 在已经执行的路径中引入了一个活动
* 选定的结果已被替换
* 已经执行的活动将被移动到将在 **工作流定义中重新执行的地方**
* 上下文实体已更改
* **工作流定义** 已被删除

{{% alert type="info" %}}

根据实际工作流量，上述情况在功能上可能不会造成问题。 当然，这需要事先了解商业领域。 因此，从商业角度来看，运行时间可能发现的冲突比严格需要的多。

{{% /报警 %}}

冲突的 Workflow 实例将被标记为状态 **不兼容**。 **原因** 字段将被更新，包含一个解释找到的冲突的文本。 无法执行此状态下的工作流。

{{% alert type="info" %}}

系统可以将不兼容的 Workflow 实例更改为状态 **InProgress** 并在随后的应用程序部署更改 **Workflow 定义** 不再冲突时自动升级它。

{{% /报警 %}}

## 4 系统模块实体

运行时间将在启动时为以下系统实体添加或更改数据：

* 检测到 Workflow 定义的更改
* 新的 **工作流版本** 实例已创建 (引用前一个实例)
* **工作流定义** 更改为指向新的 **工作流版本** 作为当前版本

 **Workflow版本** 实例还提到所有 **WorkflowTaskDefine** 存在于该模型版本的实例。

For more information, see the the [Workflow Entities in the System Module](workflows#workflow-entities) section in *Workflows*.

## 3 阅读更多

* [工作流](workflows)