---
title: "呼叫网络服务动作"
parent: "微观流动活动"
---

{{% alert type="info" %}}
这种活动只能用于微流，而不能用于纳米流。
{{% /报警 %}}

## 1 导言

调用网络服务活动可以调用 [导入的 web 服务](consumed-web-services) 操作。 您可以指定是否使用身份验证， 请求应该是什么样的，以及应该如何处理网络服务的反应。

## 2 次操作

![](attachments/19202819/19399020.png)

### 2.1 业务

**操作** 定义了被调用的 web 服务的哪些操作。

### 2.2 覆盖地点

**覆盖位置** 定义是否覆盖调用网页服务的位置。

{{% alert type="info" %}}

当使用呼叫网络服务活动调用网络服务时，网络服务的位置确定如下：

1.  如果该位置在通话-网络服务活动中被覆盖，则使用该动作中指定的位置。
2.  如果定义操作的服务有一个位置常量定义，则使用该常量的值。
3.  否则，就使用了进口网络服务WSDL中指定的地点。

{{% /报警 %}}

### 2.3 地点

**位置** 定义了如果您覆盖位置的 web 服务地址。 位置需要使用 [表达式](expressions) 输入，结果是一个有效的 URL 字符串。

### 2.4 请求时使用超时

当连接后网络服务需要太长时间才能响应时，这可以用来抛出异常。 一定时间后，将会抛出异常，微流将会回滚或进入您的自定义错误处理器。 请注意，这不会改变连接超时。

_默认值：_ 否

### 2.5 超时

**超时** 以秒为单位指定超时值。

_默认值：_ 30

### 2.6 针对WSDL验证

**校验wsdl** 是否指定调用行动是否应该验证传入和传出的 XML 是否与WSDL 相对。 请注意，Mendix 生成正确的 XML ，但应用程序数据可能会导致XML 不正确(例如不能为空的字段在您正在发送的数据中是空的)。

设置此设置为是可以大大降低性能！

{{% alert type="warning" %}}
当消耗使用编码的 WSDL 时，开启验证会导致一致性错误，因为它不符合WS-I 。
{{% /报警 %}}

配置 [消费的 web 服务](consumed-web-service) 作为附件发送二进制数据时不支持Schema 验证。

{{% alert type="info" %}}
版本7.20支持使用 [(优化) 实现](project-settings#web-service-calls) 的模式验证。
{{% /报警 %}}

_默认值：_ 否

### 2.7 代理配置

{{% alert type="info" %}}

此功能是在7.15.0版本中引入的。

此功能仅在您配置了 Web 服务通话以在 [项目运行时间设置中使用新的 (优化) 实现](project-settings) 时才可用。

{{% /报警 %}}

在几乎所有情况下，您都可以忽略此设置。 **使用工程设置** 是一个好的默认值。

如果想要，您可以配置是否为请求使用代理人。 这些选择是：

* **使用项目设置** - 使用项目一级定义的任何设置 (默认)
* **覆盖** - 此操作的项目级别设置
* **没有代理** - 即使在项目一级配置了代理，也不使用代理服务器

当您选择 **覆盖**，您可以动态地配置是否使用代理人。 然后您为代理提供主机、 端口、 用户名和密码设置。

## 3 HTTP 头

![](attachments/19202819/19399021.png)

### 3.1 使用HTTP身份验证

使用 HTTP 身份验证定义是否应使用基本身份验证。

### 3.2 用户名

用户名定义了将用于通过 HTTP 身份验证的用户名。 用户名需要使用 [表达式](expressions) 输入. 微流程表达式应产生一个字符串。

### 3.3 密码

密码定义将用于通过 HTTP 身份验证的密码。 密码需要使用 [表达式](expressions) 输入. 微流程表达式应产生一个字符串。

### 3.4 自定义 HTTP 头

这些自定义头已添加到 HTTP 请求头中。 每个自定义头都是一个键值和一个值(微流程表达式)。

## 4 个SOAP 请求头和SOAP 请求机构

![](attachments/19202819/19399022.png)

请求部件的XML（标题和正文）可以多种方式生成，下面几节对此作了描述。

### 4.1 整个请求的出口映射

使用此选项可以使用单独的 [导出映射](export-mappings) 来生成请求部件的 XML。 您可以选择用于请求部分的导出映射，如果适用的话。 您想要用作映射参数的对象或列表。

### 4.2 每个请求参数的简单表达式

当请求部件的所有子元素的子元素最多发生一次并且是原始值时，可以使用此选项。 如果不是这样，此选项将被禁用，无法使用。

使用此选项需要为原始类型的所有元素(参数)提供一个参数值。 参数值需要使用 [表达式](expressions) 输入，结果产生与参数相同的数据类型。

![](attachments/19202819/requestParamOptNil.png)

对于没有导出映射的原始参数 (可选参数和 nilble) 您现在可以选择发送上面显示的空值。

### 4.3 每个请求参数导出映射

当请求部件的 XML 元素的所有子元素最多发生一次时，此选项可以使用。 您需要为请求的所有顶级元素提供一个参数值 (参数)。 对于简单的参数，您可以输入微流表达式，对于复杂的参数，您可以定义一个映射。

{{% alert type="warning" %}}

如果原始请求参数既是可选的，也是不可靠的，那么您需要选择是否发送空值。

_默认值：_ 不发送空值。

{{% /报警 %}}

### 4.4 自定义请求模板

此选项允许您使用模板为请求部分生成XML。 模板在纯文本中定义请求部分的 XML 结构。 参数可以通过在括号之间写入数字来使用，例如'{1}'。 对于模板中的每个参数，您可以使用 [微流表达式](expressions) 来指定其值，并产生一个字符串值。

对于请求标题，Moderr 在下拉菜单中提供了一些常见的 XML 结构。

## 5 SOAP 响应

![](attachments/19202819/19399023.png)

如果数据类型是一个复杂的 XML 结构，它可以映射到使用 [导入映射](import-mappings) 的实体。 如果它是原始数据，它可以立即存储在一个变量中。 这个响应不一定要使用；如果你不感兴趣，它也可以被忽略。

### 5.1 导入映射 (复杂的 XML 结构)

在这里您可以选择 [导入映射](import-mappings) ，用于将XML 转换为对象。

### 5.2 如果没有找到对象

{{% alert type="info" %}}

该功能是在7.17.0版本中引入的。

{{% /报警 %}}

You can indicate what should happen **if not object was found** when the import mapping has checked the box **decide this at the place where the mapping gets used**.

### 5.3 参数

如果选中的映射需要一个参数，您可以在此选择它。

### 5.4 承诺

指示是否应将所产生的对象投入数据库，以及是否应触发事件处理程序。

| 选项      | 描述                                                     |
| ------- | ------------------------------------------------------ |
| 否       | 对象已保存在数据库中，触发了 [事件处理程序](event-handlers)。               |
| 是的，没有事件 | 对象已保存在数据库中，但 [事件处理程序](event-handlers) 未触发(默认)。         |
| 否       | 对象创建时没有保存到数据库中。 您将需要 [提交操作](committing-objects) 来保存它们。 |

### 5.5 范围(如果绘图得出一份清单)

范围决定有多少对象被映射并返回.

| Range | 含义                                     |
| ----- | -------------------------------------- |
| 所有的   | 映射并返回所有对象。                             |
| 第一页   | 映射并只返回第一个对象。 该动作的结果将是单个对象而不是列表。        |
| 自定义   | 映射并返回给定数量的对象(限制)。 限制是一个微流程表达式，应产生一个数字。 |

### 5.6 存储在变量

选择是否将操作结果存储在一个变量中。

### 5.7 类型

输出变量的类型。

### 5.8 名称

将保持操作结果的变量名称。
