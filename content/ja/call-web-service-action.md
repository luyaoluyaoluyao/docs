---
title: "Web サービスアクションを呼び出す"
parent: "microflow activities"
---

{{% alert type="info" %}}
この活性は、ナノフローではなく、マイクロフローでのみ使用できます。
{{% /alert %}}

## 1つの紹介

call-web-serviceアクティビティは、インポートされた [Webサービス](consumed-web-services) 操作のいずれかを呼び出すために使用できます。 認証を使用するかどうかを指定できます。 リクエストがどのように見えるべきかウェブサービスの反応がどのように処理されるべきか

## 2 操作

![](attachments/19202819/19399020.png)

### 2.1 操作

**操作** は、Web サービスのどの操作が呼ばれるかを定義します。

### 2.2 位置情報を上書き

**場所を上書きする** は、Web サービスが呼び出される場所を上書きするかどうかを定義します。

{{% alert type="info" %}}

call-web-serviceアクティビティを使用してWebサービスを呼び出す場合、Webサービスの場所は以下のように決定されます。

1.  location が call-web-service activity で上書きされている場合、そのアクションで指定された場所が使用されます。
2.  オペレーションを定義するサービスに位置定数が定義されている場合、その定数の値が使用されます。
3.  そうでなければ、インポートされた Web サービスの WSDL で指定された場所が使用されます。

{{% /alert %}}

### 2.3 場所

**Location** は、場所をオーバーライドした場合、Web サービスのアドレスを定義します。 ロケーションは [式](expressions) を使用して入力する必要があり、これにより有効な URL 文字列になります。

### 2.4 リクエスト時にタイムアウトを使用

これは、Webサービスが接続後に応答するのに時間がかかる場合に例外をスローするために使用することができます。 一定の時間が経過すると、例外がスローされ、microflow がロールバックまたはカスタムエラーハンドラーに移動します。 これは接続のタイムアウトを変更しないことに注意してください。

_デフォルト値:_ いいえ

### 2.5 タイムアウト

**タイムアウト** は秒単位でタイムアウト値を指定します。

_デフォルト値:_ 30

### 2.6 WSDL に対する検証

**wsdl に対して検証する** 呼び出しアクションが WSDL に対して受信と 送信の XML を検証するかどうかを指定します。 Mendixは正しいXMLを生成しますが、アプリケーションデータによりXMLが正しくなくなる可能性があります (例えば、送信するデータ内で空ではないフィールドが空になります)。

この設定をyesに設定するとパフォーマンスが大幅に低下します！

{{% alert type="warning" %}}
エンコーディングを使用する WSDL を使用する場合、検証を有効にすると一貫性エラーが発生します。これは、WS-I に準拠していないためです。
{{% /alert %}}

バイナリデータを添付ファイルとして送信するように [使用した Web サービス](consumed-web-service) を構成する場合、スキーマ検証はサポートされません。

{{% alert type="info" %}}
バージョン 7.20 では、 [(最適化された) 実装](project-settings#web-service-calls) を使用したスキーマ検証のサポートが導入されました。
{{% /alert %}}

_デフォルト値:_ いいえ

### 2.7 プロキシ設定

{{% alert type="info" %}}

この機能はバージョン7.15.0で導入されました。

この機能は、 [プロジェクトのランタイム設定](project-settings) で新しい (最適化された) 実装を使用するように設定されている場合にのみ使用できます。

{{% /alert %}}

ほとんどの場合、この設定は無視できます。 **プロジェクト設定を使用する** は良いデフォルト値です。

必要に応じて、リクエストにプロキシを使用するかどうかを設定できます。 選択肢は以下の通りです:

* **プロジェクト設定を使用する** – プロジェクトレベルで定義されているすべての設定を使用する (デフォルト)
* **オーバーライド** – このアクションのプロジェクトレベルの設定を上書きする
* **プロキシなし** – このアクションにプロキシを使用しないでください

**Override**を選択すると、プロキシを使用するかどうかを動的に設定できます。 その後、プロキシのホスト、ポート、ユーザー名、およびパスワードの設定を指定します。

## 3 HTTP ヘッダー

![](attachments/19202819/19399021.png)

### 3.1 HTTP 認証を使用する

HTTP 認証を使用すると、基本認証を使用するかどうかが定義されます。

### 3.2 ユーザー名

ユーザ名は、HTTP を介して認証するために使用されるユーザ名を定義します。 ユーザー名は [式](expressions) を使用して入力する必要があります。 microflow 式は文字列になります。

### 3.3 パスワード

Password は、HTTP を介した認証に使用されるパスワードを定義します。 パスワードは [式](expressions) を使用して入力する必要があります。 microflow 式は文字列になります。

### 3.4 カスタム HTTP ヘッダー

これらのカスタムヘッダーは HTTP リクエストヘッダーに追加されます。 各カスタムヘッダーは、キーと値(マイクロフロー式)のペアです。

## 4 SOAPリクエストヘッダーとSOAPリクエスト本文

![](attachments/19202819/19399022.png)

リクエスト部品の XML (ヘッダーと本文) は、以下のセクションで説明されているいくつかの方法で生成することができます。

### 4.1 リクエスト全体のエクスポートマッピング

このオプションを使用すると、単一の [エクスポートマッピング](export-mappings) を使用してリクエストパーツの XML を生成することができます。 リクエスト部分に使用するエクスポートマッピングを選択し、該当する場合はエクスポートマッピングを選択できます。 マッピングのパラメータとして使用するオブジェクトまたはリスト。

### 4.2 各リクエストパラメータのシンプルな表現

リクエストパーツのこのオプションは、リクエストパートの XML 要素の全ての子要素が一度に発生し、プリミティブ値である場合に使用することができます。 そうでない場合は、このオプションは無効化されており、使用できません。

このオプションを使用すると、プリミティブ型(パラメータ)のすべての要素に引数の値を指定する必要があります。 引数の値は [式](expressions) を使用して入力する必要があり、パラメータと同じデータ型になります。

![](attachments/19202819/requestParamOptNil.png)

エクスポートマッピングを持たないプリミティブパラメータ (オプションとnillableの両方) の場合 上記の画像のように空の値を送信できるようになりました。

### 4.3 リクエストパラメータごとにマッピングをエクスポートする

このオプションは、リクエストパートの XML 要素のすべての子要素が一度に発生する場合に使用することができます。 リクエストのすべてのトップレベル要素(パラメータ)に対して引数の値を指定する必要があります。 単純なパラメーターの場合は、マイクロフロー式を入力し、複雑なパラメーターのためにマッピングを定義することができます。

{{% alert type="warning" %}}

プリミティブリクエストパラメータがオプションとnillableの両方である場合、空の値を送信するかどうかを選択する必要があります。

_デフォルト:_ 空の値を送信しない。

{{% /alert %}}

### 4.4 カスタムリクエストテンプレート

このオプションを使用すると、テンプレートを使用してリクエスト部分のXMLを生成できます。 テンプレートにより、リクエスト部分のXML構造がプレーンテキストで定義されます。 パラメータは、ブレース間の数値を書くことで使用することができます。例えば、'{1}'。 テンプレート内の各パラメータについて、 [マイクロフロー式](expressions) を使用して値を指定することができます。

リクエストヘッダーの場合、モデラーはドロップダウンメニュー内の一般的な XML 構造を提供します。

## 5つのSOAP応答

![](attachments/19202819/19399023.png)

データ型が複雑な XML 構造の場合、 [マッピングのインポート](import-mappings) を使用してエンティティにマッピングすることができます。 プリミティブなデータであれば、すぐに変数に格納することができます。 応答は使用する必要はありません。興味がなければ無視することもできます。

### 5.1 複雑な XML 構造のマッピングのインポート

ここでは、XML をオブジェクトに変換するために使用される [マッピングのインポート](import-mappings) を選択できます。

### 5.2 オブジェクトが見つからなかった場合

{{% alert type="info" %}}

この機能はバージョン7.17.0で導入されました。

{{% /alert %}}

**オブジェクトが見つからなかった場合、** インポートマッピングがチェックされたとき、 **マッピングが使用される場所でこれを決定する**.

### 5.3 パラメータ

選択されたマッピングにパラメータが必要な場合、ここで選択することができます。

### 5.4 コミット

結果として生成されるオブジェクトをデータベースにコミットするかどうか、およびイベントハンドラをトリガーするかどうかを示します。

| Option    | 説明                                                                             |
| --------- | ------------------------------------------------------------------------------ |
| はい        | オブジェクトはデータベースに保存され、 [イベントハンドラ](event-handlers) がトリガーされます。                      |
| イベントなしではい | オブジェクトはデータベースに保存されますが、 [イベントハンドラ](event-handlers) はトリガーされません(デフォルト)。           |
| いいえ       | オブジェクトはデータベースに保存されずに作成されます。 それらを保存するには、 [コミットアクション](committing-objects) が必要です。 |

### 範囲(マッピングがリストを返す場合)

範囲は、マップされ返されるオブジェクトの数を決定します。

| Range | 意味                                                      |
| ----- | ------------------------------------------------------- |
| すべて   | すべてのオブジェクトをマップして返します。                                   |
| 最初の   | 最初のオブジェクトのみをマップして返します。 アクションの結果はリストの代わりに単一のオブジェクトになります。 |
| カスタム  | 指定された数のオブジェクトをマップして返します(limit)。 制限は数字になるマイクロフロー式です。     |

### 5.6 変数に保存

操作の結果を変数に格納するかどうかを選択します。

### 5.7 タイプ

出力変数の型。

### 5.8 名前

操作の結果を保持する変数の名前。
