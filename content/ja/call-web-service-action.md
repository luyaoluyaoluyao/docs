---
title: "Web サービスに発信"
parent: "インテグレーションアクティビティ"
tags:
  - "studio pro"
  - "統合アクティビティ"
  - "Webサービスを呼び出す"
menu_order: 20
---

{{% alert type="info" %}}
<img src="attachments/chinese-translation/china.png" style="display: inline-block; margin: 0" /> 簡体字中国語の翻訳については、 [<unk> <unk> <unk>](https://cdn.mendix.tencent-cloud.com/documentation/refguide8/call-web-service-action.pdf) をクリックしてください。
{{% /alert %}}

{{% alert type="warning" %}}
 このアクティビティは、 **Microflow** でのみ使用できます。
{{% /alert %}}

## 1つの紹介

**Web サービス** を呼び出すアクティビティは、 [インポートされた Web サービス](consumed-web-services) 操作のいずれかを呼び出すために使用できます。 認証を使用するかどうかを指定できます。 リクエストがどのように見えるべきかウェブサービスの反応がどのように処理されるべきか

## 2つのプロパティ

以下の画像に、Web サービスのプロパティを呼び出す例を示します。

![Web サービスのプロパティを呼び出す](attachments/integration-activities/call-web-service-properties.png)

このアクティビティには2つのプロパティがあります。 左側のダイアログボックスと右側のプロパティ ペインに表示されています

Web サービスのプロパティペインは以下のセクションで構成されています。

* [アクション](#action)
* [一般的な](#common)

## 3つのアクションセクション{#action}

プロパティ ペインの **アクション** セクションには、このアクティビティに関連付けられたアクションが表示されます。

アクションの横にある省略記号 (**…**) をクリックすることで、このアクションを構成するためのダイアログボックスを開くことができます。

また、マイクロフロー内のアクティビティをダブルクリックするか、アクティビティを右クリックして **プロパティ** を選択することで、ダイアログボックスを開くこともできます。

プロパティ ダイアログ ボックスは 5 つのタブで構成されています:

* [操作](#operation)
* [HTTP ヘッダー](#http-headers)
* [SOAPリクエストヘッダー](#request-header)
* [SOAPリクエスト本文](#request-body)
* [SOAP対応](#response)

## 4つの操作タブ{#operation}

![](attachments/integration-activities/operation-tab.png)

### 4.1 操作

**操作** は、Web サービスのどの操作が呼ばれるかを定義します。

### 4.2 場所を上書き

**場所を上書きする** は、Web サービスが呼び出される場所を上書きするかどうかを定義します。

{{% alert type="info" %}}

コールWebサービスアクティビティを利用してWebサービスを呼び出す場合、以下のようにWebサービスの場所が決定されます。

1.  場所がコール Web サービス アクティビティで上書きされている場合、そのアクションで指定された場所が使用されます。
2.  オペレーションを定義するサービスに位置定数が定義されている場合、その定数の値が使用されます。
3.  そうでなければ、インポートされた Web サービスの WSDL で指定された場所が使用されます。

{{% /alert %}}

### 4.3 場所

**Location** は、場所をオーバーライドした場合、Web サービスのアドレスを定義します。 ロケーションは [式](expressions) を使用して入力する必要があり、これにより有効な URL 文字列になります。

### 4.4 リクエスト時にタイムアウトを使用

これは、Webサービスが接続後に応答するのに時間がかかる場合に例外をスローするために使用することができます。 一定の時間が経過すると、例外がスローされ、microflow がロールバックまたはカスタムエラーハンドラーに移動します。

既定値: *はい* (Studio Pro [8.5.0](/releasenotes/studio-pro/8.5#850)の時点で; 以前のバージョンでは、デフォルト値は No でした)

{{% alert type="warning" %}}
この設定を **はい**にしておくことをお勧めします。 (Mendix Cloudで使用されているものを含む)ほとんどのクラウドインフラストラクチャサービスは、数分間トラフィックがない場合、自動的にHTTP接続を閉じます。 活動がまだ反応を待っていてもね これは、アクティビティがWebサービスを呼び出す場合、応答に長い時間がかかることを意味します。 これを認識せずに接続が切断される可能性があります。あなたのアクティビティには応答がありません。 このような状況では、 **リクエスト時のタイムアウトを使用する** が **いいえ**に設定されている場合 データが届くのを無期限に待ってるんだ
{{% /alert %}}

デフォルト: *いいえ*

### 4.5 タイムアウト

**タイムアウト** は秒単位でタイムアウト値を指定します。

デフォルト値: *300* (Studio Pro [8.5.0](/releasenotes/studio-pro/8.5#850)の時点で; 以前のバージョンではデフォルト値は 30)

### 4.6 WSDL に対する検証

**wsdl に対して検証する** 呼び出しアクションが WSDL に対して受信と 送信の XML を検証するかどうかを指定します。 Mendixは正しいXMLを生成しますが、アプリケーションデータによりXMLが正しくなくなる可能性があります (例えば、送信するデータ内で空ではないフィールドが空になります)。

この設定をyesに設定するとパフォーマンスが大幅に低下します！

{{% alert type="warning" %}}
エンコーディングを使用する WSDL を使用する場合、検証を有効にすると一貫性エラーが発生します。これは、WS-I に準拠していないためです。
{{% /alert %}}

バイナリデータを添付ファイルとして送信するように [使用した Web サービス](consumed-web-service) を構成する場合、スキーマ検証はサポートされません。

デフォルト: *いいえ*

### 4.7 プロキシ設定

ほとんどの場合、この設定は無視できます。 **プロジェクト設定を使用する** は良いデフォルト値です。

必要に応じて、リクエストにプロキシを使用するかどうかを設定できます。 選択肢は以下の通りです:

* **プロジェクト設定を使用する** – プロジェクトレベルで定義されているすべての設定を使用する (デフォルト)
* **オーバーライド** – このアクションのプロジェクトレベルの設定を上書きする
* **プロキシなし** – このアクションにプロキシを使用しないでください

**Override**を選択すると、プロキシを使用するかどうかを動的に設定できます。 その後、プロキシのホスト、ポート、ユーザー名、およびパスワードの設定を指定します。

### 4.8 クライアント証明書

{{% alert type="warning" %}}
この機能は Mendix 8.18.0 以降で使用できます。
{{% /alert %}}

ほとんどの場合、デフォルトの **プロジェクト設定を使用する** が使用できます。

ただし、 **上書き** をクリックすることで、リクエストに使用するクライアント証明書を指定することができます。 次のいずれかから選択します:

* **プロジェクト設定を使用する**(デフォルト) – プロジェクトレベルで定義されている設定を使用する
* **オーバーライド** – このアクションのプロジェクトレベルの設定を上書きする

**Override**を選択すると、使用されるクライアント証明書を構成することができます。 **編集** をクリックして、 **クライアント証明書識別子** を指定します。 この識別子は、アプリのデプロイ先によって異なる場所で設定できます。

* Mendix クラウドにアプリをデプロイする場合、 [クライアント証明書をピン留めするときに識別子が設定されます](/developerportal/deploy/certificates#outgoing-client-certificates)
* アプリケーションを他の場所にデプロイする場合、その識別子はカスタム設定 [ClientCertificateUsages](custom-settings#ca-certificates) で設定されます。

When this identifier is not set (either not pinned or not present in _ClientCertificateUsages_), the default settings will be used (as if **Use project settings** were selected).

## 5 HTTP ヘッダータブ{#http-headers}

![](attachments/integration-activities/http-headers-tab-call-web-service.png)

### 5.1 HTTP 認証を使用する

HTTP 認証を使用すると、基本認証を使用するかどうかが定義されます。

### 5.2 ユーザー名

ユーザ名は、HTTP を介して認証するために使用されるユーザ名を定義します。 ユーザー名は [式](expressions) を使用して入力する必要があります。 microflow 式は文字列になります。

### 5.3 パスワード

Password は、HTTP を介した認証に使用されるパスワードを定義します。 パスワードは [式](expressions) を使用して入力する必要があります。 microflow 式は文字列になります。

### 5.4 カスタム HTTP ヘッダー

これらのカスタムヘッダーは HTTP リクエストヘッダーに追加されます。 各カスタムヘッダーは、キーと値(マイクロフロー式)のペアです。

## 6SOAPリクエストヘッダータブ {#request-header}

リクエストヘッダーの場合、Studio Proはドロップダウンメニューに共通のXML構造を提供します。

## 7SOAPリクエストボディタブ {#request-body}

![](attachments/integration-activities/soap-request-body-tab.png)

リクエスト部品の XML (ヘッダーと本文) は、いくつかの方法で生成することができます。 が選択されている場合は、次のセクションで説明されています。

### 7.1 リクエスト全体のエクスポートマッピング

このオプションを使用すると、単一の [エクスポートマッピング](export-mappings) を使用してリクエストパーツの XML を生成することができます。 リクエスト部分に使用するエクスポートマッピングを選択し、該当する場合はエクスポートマッピングを選択できます。 マッピングのパラメータとして使用するオブジェクトまたはリスト。

### 7.2 各リクエストパラメータのシンプルな表現

リクエストパーツのこのオプションは、リクエストパートの XML 要素の全ての子要素が一度に発生し、プリミティブ値である場合に使用することができます。 そうでない場合は、このオプションは無効化されており、使用できません。

このオプションを使用すると、プリミティブ型(パラメータ)のすべての要素に引数の値を指定する必要があります。 引数の値は [式](expressions) を使用して入力する必要があり、パラメータと同じデータ型になります。

![](attachments/integration-activities/request-parameter-option.png)

エクスポートマッピングを持たないプリミティブパラメータ (オプションとnillableの両方) の場合 空の値を送信するには、 **空の値を** に **に送信する はい、null** を選択します。

### 7.3 リクエストパラメータごとにマッピングをエクスポートする

このオプションは、リクエストパートの XML 要素のすべての子要素が一度に発生する場合に使用することができます。 リクエストのすべてのトップレベル要素(パラメータ)に対して引数の値を指定する必要があります。 単純なパラメーターの場合は、マイクロフロー式を入力し、複雑なパラメーターのためにマッピングを定義することができます。

{{% alert type="warning" %}}

プリミティブリクエストパラメータがオプションとnillableの両方である場合、空の値を送信するかどうかを選択する必要があります。

*デフォルト値*: 空の値を送信しないでください。

{{% /alert %}}

### 7.4 カスタムリクエストテンプレート

このオプションを使用すると、テンプレートを使用してリクエスト部分のXMLを生成できます。 テンプレートにより、リクエスト部分のXML構造がプレーンテキストで定義されます。

#### 7.4.1 文字列テンプレート{#string-template}

XML リクエストのテンプレートには、括弧間の数値として記述されたパラメータを含めることができます (例: `{1}`)。 最初のパラメータは `1`、2 番目の `2`などの数字を持ちます。 opening brace (`{`), double opening brace (`{{` ) を使ってエスケープすることができます。

#### 7.4.2 パラメータ

テンプレート内の各パラメータに対して、文字列値を生成する [マイクロフロー式](expressions) を使用してその値を指定できます。 この値はパラメーターの位置に挿入されます。

## 8 SOAP応答タブ{#response}

![](attachments/integration-activities/soap-response-tab.png)

データ型が複雑な XML 構造の場合、 [マッピングのインポート](import-mappings) を使用してエンティティにマッピングすることができます。 プリミティブなデータであれば、すぐに変数に格納することができます。 応答は使用する必要はありません。興味がなければ無視することもできます。

### 8.1 マッピング

複雑な XML 構造を使用している場合は、XML をオブジェクトに変換するために使用される [マッピングのインポート](import-mappings) を選択できます。

### 8.2 オブジェクトが見つからなかった場合

**オブジェクトが見つからなかった場合、** インポートマッピングがチェックされたとき、 **マッピングが使用される場所でこれを決定する**.

### 8.3 パラメータ

選択されたマッピングにパラメータが必要な場合、ここで選択することができます。

### 8.4 コミット

結果として生成されるオブジェクトをデータベースにコミットするかどうか、およびイベントハンドラをトリガーするかどうかを示します。

| Option    | 説明                                                                             |
| --------- | ------------------------------------------------------------------------------ |
| はい        | オブジェクトはデータベースに保存され、 [イベントハンドラ](event-handlers) がトリガーされます。                      |
| イベントなしではい | オブジェクトはデータベースに保存されますが、 [イベントハンドラ](event-handlers) はトリガーされません(デフォルト)。           |
| いいえ       | オブジェクトはデータベースに保存されずに作成されます。 それらを保存するには、 [コミットアクション](committing-objects) が必要です。 |

### 8.5 範囲 (マッピングがリストを返す場合)

範囲は、マップされ返されるオブジェクトの数を決定します。

| Range | 意味                                                            |
| ----- | ------------------------------------------------------------- |
| すべて   | すべてのオブジェクトをマップして返します。                                         |
| 最初の   | 最初のオブジェクトのみをマップして返します。 アクションの結果はリストの代わりに単一のオブジェクトになります。       |
| カスタム  | 指定された数のオブジェクトをマップして返します(limit)。 制限は、数字を生成しなければならないマイクロフロー式です。 |

### 8.6 変数に保存

操作の結果を変数、オブジェクト、またはリストに保存するかどうかを選択します。

### 8.7 タイプ

出力のタイプ。

### 8.8 名前

操作の結果を保持する出力の名前。

## 9つの共通セクション{#common}

{{% snippet file="refguide8/microflow-common-section-link.md" %}}
