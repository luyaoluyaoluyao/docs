---
title: "アクセスルール"
parent: "エンティティ"
menu_order: 70
tags:
  - "ドメインモデル"
  - "エンティティ"
  - "アクセスルール"
  - "xpath 制約"
  - "モジュールの役割"
  - "studio pro"
---

## 1つの紹介

エンティティの **アクセス ルール** は、ユーザーがエンティティのオブジェクトに対して許可されることを定義します。 ユーザーは、オブジェクトの作成や削除、メンバーの値の表示や編集を許可することができます。 メンバは、エンティティの属性または関連付けです。 更に、 [XPath 制約](xpath-constraints) を使用して、表示、編集、および削除に使用することのできるオブジェクトのセットを制限することができます。

すべてのアクセスルールは、1つまたは複数の [モジュールロール](module-security#module-role)に適用できます。 アクセスルールは、それらのロールへの特定のアクセス権を付与します。 ルールは付加的なものです。つまり、複数のアクセスルールが同じモジュールロールに適用される場合です。 それらのルールのすべてのアクセス権は、そのモジュールの役割のために結合されます。

{{% alert type="warning" %}}
アクセス ルールはエンティティの [一般化](entities#generalization)から継承されません。すべてのエンティティのセキュリティは明示的に指定されます。 つまり、エンティティにアクセスルールを追加する場合、必要なすべての XPath 制約が適用されることを常に確認してください。

XPath 制約を定義するアクセスルールを持つ一般化がエンティティにある場合。 これらはその専門分野には当てはまりませんそのため視認性を制限することはありません
{{% /alert %}}


## 2つのプロパティ

Access rules are defined via entity's **Properties** > **Access rules**, or on the **Access rules** tab of the entity dialog.

![エンティティのアクセスルール](attachments/domain-model/access-rules-section.png)

![エンティティのアクセスルール](attachments/domain-model/access-rules-tab.png)

{{% alert type="info" %}}
**アクセス ルール** セクションは、 [アプリ セキュリティ](project-security) が **プロダクション** に設定されている場合にのみ表示されます。
{{% /alert %}}

以下の画像にアクセス ルール プロパティの例を示します。

![エンティティのアクセスルール](attachments/domain-model/access-rules-properties.png)

アクセス ルール プロパティは、次のセクションで構成されています。

* [ドキュメント](#documentation)
* [モジュールの役割](#module-roles)
* [アクセス権](#access-rights)
* [XPath 制約](#xpath-constraint)

### 2.1 ドキュメントセクション {#documentation}

**ドキュメント**では、アクセス ルールの意図を説明できます。 これにより、特に些細なXPath 条件式の場合には、アクセスルールを理解することができます。

### 2.2 ルールは次のモジュールロールセクションに適用されます {#module-roles}

#### 2.2.1 ロール

すべてのモジュールロールがリストされ、このアクセスルールが適用されるものがチェックされます。 チェックされたモジュールロールの少なくとも1つを持つすべてのユーザーは、ルールが定義するアクセス権を取得します。

#### 2.2.2 すべての選択/選択解除

このチェックボックスを使用して、すべてのモジュールロールを簡単に選択または選択解除できます。

### 2.3 アクセス権タブ{#access-rights}

**アクセス権** タブでは、選択したモジュールロールを持つユーザーに権限を割り当てることができます。

#### 2.3.1 権限セクションの作成と削除

##### 2.3.1.1 新しいオブジェクトの作成を許可

**新規オブジェクトの作成を許可する** がチェックされている場合、ユーザーはこのエンティティの新しいオブジェクトを作成することができます。

##### 2.3.1.2 既存のオブジェクトの削除を許可

**Allow deleting existing object** is checked, users are allowed to delete existing objects of this entity.

削除することのできるオブジェクトの集合は、 [XPath 制約](#xpath-constraint) を使用して制限することができます。

#### 2.3.2 メンバー 読む & 書き込み権限セクション

**メンバーの読み書き権** は、エンティティのすべてのメンバー([属性](attributes) または [アソシエーション](associations))に対するアクセス権を定義します。 これらのアクセス権は、ユーザーがメンバーの値を表示および/または編集できるかどうかを示します。 これらの権利が適用されるオブジェクトの集合は、 [XPath constraint](#xpath-constraint) を使用することで制限することができます。

| 値         | 説明                                       |
| --------- | ---------------------------------------- |
| -         | ユーザーは、メンバーの値を表示または編集することはできません。          |
| 既読にする     | ユーザーはこのメンバーの値を表示することができますが、編集することはできません。 |
| 読み込み、書き込み | ユーザーは、このメンバーの値を表示および編集することができます。         |

{{% alert type="info" %}}
計算された属性に *書き込み* アクセス権を設定できません。 これには、 *Autonumber* 型の属性と、属性値が **Calculated** に設定された属性が含まれます。
{{% /alert %}}

**新規メンバーのデフォルトの権利** は、このエンティティの新しい属性または関連付けに適用される権利を指定します。

**Set all to** allows you to quickly set all the access rights for members to **None**, **Read**, or **Read, Write**.

たとえば、顧客は割引を表示することができますが、それを編集することはできません。 割引属性のアクセス権は、 **Read** です。

![](attachments/domain-model/access-rule-discount-read.png)

### 2.4 XPath 制約タブ {#xpath-constraint}

[XPath 制約](xpath-constraints) を使用すると、アクセスルールが適用されるオブジェクトの集合を制約することができます。 XPath 制約が空の場合、エンティティのすべてのオブジェクトにルールが適用されます。

![](attachments/domain-model/access-rule-xpath-tab.png)

例えば、 **顧客** エンティティは、 **ユーザー** エンティティの専門分野です。 **Order** エンティティは **Customer** エンティティに関連付けられています。

ログイン中の顧客は個人的な注文を表示することができますが、他の顧客の注文を表示することはできません。 これは、 **注文** エンティティのアクセスルール内で以下の XPath 制約を使用することにより実現されます。

```java
[Module.Order_Customer = '[%CurrentUser%]']
```

![](attachments/domain-model/access-rule-order-xpath.png)

この XPath 制約により、アクセスルールは現在サインインしているユーザーの注文にのみ適用されます。

{{% alert type="warning" %}}
XPath 制約はデータベースにより適用される永続的なエンティティに対してのみ適用することができます。 持続不可能なエンティティのための XPath 制約を定義すると、一貫性エラーが発生します。
{{% /alert %}}
