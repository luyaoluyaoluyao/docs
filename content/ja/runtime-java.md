---
title: "Mendix Runtime & Java"
category: "Mendix Runtime"
tags:
  - "ランタイム:"
  - "ジャバ"
---

## 1つの紹介
Mendixを開発または実行している場合は、遅かれ早かれJavaに連絡します。 このドキュメントでは、Mendix で Java の基本的な概念のいくつかを説明します。

## 2つのコンセプト
Java の概念は以下のとおりです。

### 2.1 Java Virtual Machine (JVM)
Mendixを使用する場合は、Java(JDK)と一緒に使用して、実際のアプリケーションをJava仮想マシン(JVM)でデプロイして実行します。 JVM は、Mendix アプリケーションが実行されるコンテナです。 次のようになります：

![](attachments/mendix-runtime-java/2.jpg)

または、Mendix Cloudに表示されているように:

![](attachments/mendix-runtime-java/4.jpg)

### 2.2 PermGen

[Permgen Generation](https://docs.oracle.com/javase/7/docs/webnotes/tsg/TSG-VM/html/tooldescr.html#gblmm) (PermGen) はクラスとライブラリを保持しており、実際に使用された場合にのみPermGenにロードされます。 Javaヒープ空間の一部ではなく、Java8では存在せず、メタデータと呼ばれるものに置き換えられます。 これらの概念は、主にプロジェクトの userlib ディレクトリに追加するライブラリに関連します。 それらが(Javaの呼び出しを介して)マイクロフローのどこかで使用されると、PermGen (Java 7およびそれ以前)またはメタデータ (Java 8)に追加されます。 これらの用語に関連するエラーが発生した場合、どこから探し始めればよいのか分かります。

### 2.3 スタック

もう一つの興味深い分野はスタックです。 これは、とりわけ、マイクロフロー、ドメインモデルおよびその他のMendix固有の情報に関するすべての情報を保持するものです。 実行されるすべてのマイクロフローは、スタックに終わることになります(上のグラフの *スレッドスタック* を参照)。

### 2.4 ヒープ、ガベージコレクタ、OOM エラー

次はヒープスペース(ヒープ)です。 しかし、その前に、JVM のもう一つの重要な部分、すなわちガベージコレクター(GC)について簡単に説明しましょう。

GC の責任者:

*   メモリの割り当て
*   参照されたオブジェクトがメモリ上に残るようにすること
*   コードの実行時に参照からアクセスできなくなったオブジェクトによって使用されるメモリを回復する

簡単に言えば、現在使用されているヒープ内のオブジェクト(かなり広い概念です)は、生きていると考えられています。 もはや使用されていないすべてのオブジェクトは死んだと見なされます。 GCは、ヒープ内のメモリを再び解放するために、これらの死んだオブジェクトをすべて削除するようにします。

GCは、メモリエラー(OOMエラー)自体を防止する責任を負いません。 例えば、無期限にオブジェクトを作成し続けることができますし、そうするまでそれらは生き続けることができます。 GCはこれらのオブジェクトにも触れませんが、OOMエラーに終わることになります。

ヒープに戻る。 これを３つの部分に分けることができます

1.  エデン空間（若い世代）
2.  サバイバー空間（若い世代）
3.  世襲（旧世代）

GCがマイナーなガベージコレクションを実行すると、若い世代のすべてのオブジェクトをクリーンアップしようとします。 エデン空間オブジェクトをクリーンアップできない場合は、Survivor Spaceに移動します。 Survivor Spaceオブジェクトを十分な時間でクリーンアップできなかった場合は、それをTenured Generationに移動します。 生殖能力が十分に大きくなった場合(ヒープが利用できるスペースの約60%)は、主要なガベージコレクションを実行し、若い世代と古い世代の両方のオブジェクトをすべてクリーンアップしようとします。 したがって、健全なJVMは、さまざまな部分におけるメモリ使用量に関連して上下するヒープを備えています。

Mendix Cloudから取得された以下のJVMオブジェクトヒープグラフでは、これがよく分かります。

![](attachments/mendix-runtime-java/5.jpg)

紫と緑のスパイクはマイナーなゴミ収集品です。 赤色部分に大きな落下が大きなゴミ収集品です。 これは健康そうなヒープです。

### 2.5 アプリケーション サーバー

そして最後に、上記のすべてが一緒に来るMendix Cloudのグラフ。

![](attachments/mendix-runtime-java/6.jpg)

緑色の部分(アプリ)は、基本的にMendixアプリケーションが実行されているJVMです。 他のものは、アプリケーションサーバーのオペレーティングシステム用に予約されています。

## 3 続きを読む

* [一時オブジェクト & ごみ収集中](transient-objects-garbage-collecting)
* [Java メモリ使用量](java-memory-usage)
* [一般的なランタイム & Java エラー](runtime-java-errors)

