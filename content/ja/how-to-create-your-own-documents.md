---
title: "独自のドキュメントを作成する"
parent: "ドキュメントテンプレート"
description: "このドキュメントでは、Mendix を使用したドキュメントの作成に関する洞察を提供します。"
tags:
  - "ドキュメント"
  - "生成"
  - "単語"
  - "PDF"
---

## 1つの紹介

Mendixで独自のドキュメントを作成する方法を考えていましたか? このリファレンスはあなたにそれを行う方法を教えてくれます!

Mendix を使用すると、さまざまな方法でドキュメントを生成できます。 ここでは、自分のアプリケーションからドキュメントを生成するための基礎を学びます。

始める前に、最初に次の2つのMendixリファレンスガイドのページを読むことをお勧めします。

* [ドキュメントテンプレート](ドキュメントテンプレート)
* [ドキュメントの生成](generate-document)

## 2あなたの書類を知る

Mendixでドキュメントを作成する前に、生成したいドキュメントのドラフト版を作成することをお勧めします。 紙に何かをスケッチしたり、お客様に例を提供してもらうことができます。 いずれにせよ、あなたが達成したいことを念頭に置いておくのは良いことです。

目的のドキュメントを使用して、それを作成するための戦略を選択できます。 Mendixには、すぐに使えるドキュメントテンプレート機能を使用してドキュメントを作成するための多数のオプションがあります。 しかし、Mendixの機能がドキュメントを生成するのに十分ではないことがわかるかもしれません。 心配しないで。 Mendix でドキュメントを作成する別の方法については、 [ドキュメントを作成する代替方法](#Alternative) を参照してください。

例えば、Mendixの機能は十分であると結論付けました。 では例を見てみましょう

## 3 ビジネス ケース

このアプリケーションでは、顧客は製品を購入することができます。 彼らは注文を作成し、購入する製品を選択することによってそうします。 注文の概要をお客様に提示できるようにするには PDFが作成され、確認メールの添付ファイルとしてお客様に送信されます。 注文は、顧客の詳細を表示する必要があります, 会社のロゴ, 彼らの価格で製品, そして、注文の合計値.

## 4 ボックス外のMendix機能を備えたドキュメントの生成

### 4.1 ドメインモデル

このアプリケーションのドメインモデルは次のようになります。

![](attachments/modeler-core/2018-02-28_16-37-25.png)

**顧客** は、住所情報と優先通信言語を保持しています。 **Order** は、すべての注文行の日付と合計を所有します。 **注文ライン** エンティティには、 **商品** の顧客固有の価格があります。 ドキュメントを生成するため、 **OrderDocument** エンティティが追加されました。 このエンティティは **System.FileDocument** エンティティを継承します。

{{% alert type="info" %}}
**システムを使用しないでください。 ileDocument **** エンティティを直接、あなたは **システム** モジュールからその部品のセキュリティを制御することができないため。 </p>
{{% /alert %}}

### 4.2 Microflow

ドメインモデルが設定されました。新しい生成ドキュメント機能のマイクロフローを作成する準備ができました。

新しいフォルダを作成して、すべての注文ドキュメント作成関連のソースを整理します。

![](attachments/modeler-core/2018-02-28_17-02-05.png)

ドキュメントの作成を処理するためのマイクロフローが必要になります。

![](attachments/modeler-core/2018-02-28_17-04-03.png)

マイクロフローは、現在のデフォルトの開始と終了点だけで構成されています。

![](attachments/modeler-core/2018-02-28_16-30-18.png)

マイクロフローを作成したら、ドキュメントでどの情報を使用するかを決定します。 注文を入力として始めましょう。 後で、注文インスタンスを介して追加のデータを取得できます。

{{% alert type="info" %}}
マイクロフローを作成するときは、再利用を促進するための入力パラメータの数を制限することをお勧めします。
{{% /alert %}}

ここに入力パラメータがあります:

![](attachments/modeler-core/2018-02-28_16-32-33.png)

次のステップでは、新しいOrderDocumentを作成します。 このオブジェクトは実際のドキュメントを保存します。 参照を **Order** 変数とドキュメントの名前に設定します。

![](attachments/modeler-core/2018-02-28_16-52-43.png)

ここで、 **Language** オブジェクトが必要になります。 私たちの場合、 **顧客** は優先通信言語を保持しています。 In our microflow example, you first retrieve the **Customer** via the **Order**, and then retrieve the **Language** from that **Customer**:

![](attachments/modeler-core/2018-02-28_16-58-54.png)

次のステップは、 **ドキュメント** の生成アクティビティを使用することです。 このアクティビティでは、使用可能な変数を使用してドキュメントテンプレートを選択してドキュメントを作成できます。 ただし、ドキュメントテンプレートはまだ存在しないため、作成してフォルダに配置する必要があります:

![](attachments/modeler-core/2018-02-28_17-06-53.png)

これはドキュメントテンプレートの構成です:

![](attachments/modeler-core/2018-03-01_13-03-55.png)

{{% alert type="info" %}}
選択したテンプレートに加えた変更に基づいて、引数が変更されます。
{{% /alert %}}

**ドキュメント生成** アクティビティが追加されました:

![](attachments/modeler-core/2018-03-01_13-06-33.png)

ドキュメントテンプレートの一般的な設定を行った後、 **NewOrderDocument** のコミットを分離する必要はありません。 このエンティティはドキュメントテンプレートアクティビティを介して自動的にコミットされます。

ドキュメントを生成する **** 構成を設定したので、テンプレート自体を構成することができます。

{{% alert type="info" %}}
ドキュメントテンプレートで使用されるエンティティとその属性に正しいエンティティアクセス権を設定してください。 読み取りアクセスは、テンプレートに表示されている属性には必須です。 ここに **顧客** エンティティがあり、 **読み取り、** を **ユーザー** モジュールのロールに書き込みます：

![](attachments/modeler-core/2018-03-01_13-12-28.png)

{{% /alert %}}

### 4.3 ドキュメントテンプレート

この例では、次のドキュメント テンプレートを使用できます。

![](attachments/modeler-core/2018-03-01_14-05-07.png)

このドキュメントテンプレートでは、注文の詳細を含むデータ ビューから始めます。 この注文から、顧客情報を取得し、注文行から購入した製品に関する情報を取得できます。

データビューは、ドキュメントを構成するためにテーブル、テーブルセル、ラベル、画像、改行、およびテンプレートグリッドを使用します。

ドキュメントテンプレートを作成したので、エラードックにエラーがあることがわかります:

![](attachments/modeler-core/2018-03-01_14-08-48.png)

このエラーを解決するには、マイクロフローの **ドキュメント** を生成するアクティビティを開きます。 アクティビティが開かれると、パラメーターのマッピングが更新され、マッピングパラメーターに割り当てられた変数が更新されます。

これで、 **ドキュメントを生成する** の設定は次のようになります。

![](attachments/modeler-core/2018-03-01_14-12-03.png)

ドキュメントテンプレートが設定され、マイクロフローが使用できるようになりました。 このマイクロフローをサブマイクロフローと呼ぶ場合、ダウンロードアクティビティをメインのマイクロフローに追加できます。 このマイクロフローは
* サブマイクロフローを呼び出してドキュメントを作成します
* 作成されたドキュメントを取得して
* ファイルをダウンロード:

![](attachments/modeler-core/2018-03-01_14-21-38.png)

これが結果として生成されるドキュメントです:

![](attachments/how-to-create-your-own-documents/15_Result.png)

この例では、 **Entity (path)** データソースを介して **OrderLine** 情報を取得しました。 これを行う別の方法は、リストプレゼンテーションのオブジェクトを返すマイクロフローを使用することです。 これを行う場合 ドキュメント テンプレート内のデータ ソース マイクロフローとして使用されているマイクロフローに正しいユーザー ロールを追加するようにしてください。

## ドキュメントを作成する5つの別の方法<a name="Alternative"></a>

ドキュメントを生成するもう1つの方法は、ITextというJava APIを使用することです。 このJavaライブラリは無料で使用できます。

この作業方法の詳細については、 [iText Developers](http://developers.itextpdf.com/developers-home) を参照してください。
