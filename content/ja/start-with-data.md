---
title: "あなた自身のデータから開始"
description: "Mendix Studio で、Excel スプレッドシートをドメインモデルにインポートする方法を説明します。"
tags:
  - "スタジオ"
  - "ドメインモデル"
  - "Excelインポート"
  - "データから始める"
  - "データモデル"
---

## 1つの紹介

スプレッドシートの **App** を使用すると、Microsoft Excel スプレッドシートをインポートし、データを使用してアプリを作成できます。 スプレッドシートのデータが分析され、エンティティ、属性、関連付けに変換されます。 また、データに基づいてページやナビゲーション項目を作成することができます。

## 2 つの前提条件

スプレッドシートに基づいてアプリを作成するには、開発者ポータルのスプレッドシート **アプリ** を使用する必要があります。 次の操作を行います:

1. スプレッドシートが *.xlsx* 形式であることを確認してください

2. 開発者ポータルを開き、右上隅にある **Create App** ボタンをクリックします。

3. スプレッドシートから **アプリ** を選択し、スプレッドシートのインポート機能を使用したアプリを作成します。

4.  スプレッドシートが以下の要件を満たしていることを確認してください:<br/>

    a ファイルのサイズが1MBを超えていません。 <br/>

    B ワークシートの数は50を超えません。<br/>

    C ワークシートあたりの列数は 100 を超えていません。<br/>

    D 列名は 100 文字を超えていません。<br/>

5.  スプレッドシートにデータが正規化されていることを確認します。 以下の要件が満たされているか確認してください:

    a 各列は、ワークブック内で一意の名前を付ける必要があります。

      {{% alert type="info" %}}列名が複数の行で構成されている場合、Mendix Studioは最初の列だけを処理します。 列に名前がなくても値がある場合は、"_EMPTY" という名前になります。

      {{% /alert %}}

    B ワークシートの各セル(行または列)には、単一の値または空の値を含める必要があります。

    C 2つの列間にリンク(関連付け)を作成する場合は、上記の条件が満たされていることを確認してください。 <br/>

## データの変換

インポート処理中に、スプレッドシートデータが分析され、次の方法で変換されます:

1. ワークシートはエンティティに変換されます。

2. 列は属性に変換されます。

3. ワークシート間のリンクは同定され、以下のすべての条件が満たされている場合、関連付けに変換することができます。 <br/> a. 表計算ドキュメント内の1つの列の値はすべて別の列で使用されます。<br/>b. 他の列の値は一意です。 <br/>c. これらの列のデータ型は、文字列または列挙属性型に変換されます。 Excel データ型と属性型の対応についての詳細は、 [Excel データ型と 属性型間の対応](#excel-type-attribute-type) セクションを参照してください。<br/>

このExcelスプレッドシートの例をダウンロードして、データが正規化されているかを確認します: [スプレッドシート例](attachments/start-with-data/Example.xlsx). アプリにインポートして、このスプレッドシートの変換方法をテストすることもできます。 詳細については、 [スプレッドシートをインポートする](#importing-spreadsheet) セクションを参照してください。


## 4 スプレッドシートからアプリを起動する {#importing-spreadsheet}

アプリを作成すると、スプレッドシートをアップロードできるページが開きます。 表計算ドキュメントをページにドラッグ&ドロップするか、ファイルを参照してインポートしたいものを選択します。

{{% image_container width="500" %}}![](attachments/start-with-data/drag-and-drop.png)
{{% /image_container %}}

{{% alert type="info" %}}

データなしで開始する場合は、空白のアプリがあり、後でスプレッドシートをインポートすることはできません。

{{% /alert %}}

### 4.1 スプレッドシートデータのプレビュー

インポートするスプレッドシートを選択すると、データが分析され、リレーションシップ(関連付け)があるワークシートが特定されます。

{{% image_container width="400" %}}![](attachments/start-with-data/relations-identified.png)
{{% /image_container %}}

**データプレビュー**では、実際のインポートが完了する前に表計算データを確認できます。 テーブルと列を確認し、インポートしたくないテーブルのチェックを外すことができます。 リレーションシップ(関連)が検出されたテーブルには、リンクアイコンが表示されます:

![](attachments/start-with-data/data-preview.png)

関連付けがある列はインポートの選択を解除できません。最初に関連付けを削除する必要があります。

関連付けのリストを確認し、作成したくない関連のリストを選択解除するには、 **関連の管理** をクリックします。 **リレーションの管理** ポップアップウィンドウで あなたは、** から ** 関連を作成するためにどのテーブルと列を使用するかを確認し、 **から** 関連を作成するために使用される **へ**。 一意のデータを持つ列は、関連付けが **から** に渡される列です。

![](attachments/start-with-data/manage-relations.png)

例えば、 上の画像では、 **MarketingDocs** エンティティから **Contributors** エンティティへの関連付けが作成されます。 この関連付けは、 **MarketingDocs** の **Responsible** 列と **Name** の **Contributors** で発見されました。  As a result, when data is imported the **MarketingDocs** entity will not have **Responsible** as an attribute, instead it will have an association to the **Contributors** entity and will get data from this entity through the association.

{{% alert type="info" %}}

列は **から** 関連付けを作成するのに使用できます。 **を** 列からリードするように関連付けが作成された場合、リンクを **と** へのリンクとして作成することはできません。

{{% /alert %}}

各列の下部(属性に変換される)では、属性タイプが自動的に識別され、示されます。 ドロップダウンメニューをクリックして、属性の種類を変更します。 Excel データ型が属性型に対応する方法については、 [Excel データ型と属性型の対応](#excel-type-attribute-type) を参照してください。

![](attachments/start-with-data/attribute-type-drop-down.png)

**Generate pages for my data** will generate an overview page with a data grid for you, and *{EntityName}__NewEdit* pages for each entity. 詳細については、 [ページの生成](#generating-pages) を参照してください。

![](attachments/start-with-data/generate-pages-option.png)


#### 4.1.1 Excel データ型と属性型の対応 {#excel-type-attribute-type}

以下の表では、Excel データが属性タイプに対応する方法を確認できます。

| Excel データ                                                                                                                                                                                                                              | 属性タイプ                                                          |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------- |
| 以下のExcelデータは、文字列属性タイプに変換されます:<br />1. データなし：値なし、空の列。<br />2. 下記のいずれの場合にも該当しない場合。                                                                                                                                           | 文字列                                                            |
| 列内の値が以下の場合、Excel データはブール属性型に変換されます。 <ul><li>1 と 0</li><li>Y/y, N/n</li><li>はいそしていいえ</li><li>♪true and false ♪</li></ul>                                                                                                                                                                           | Boolean                                                        |
| 種類のデータ 一般的なデータまたは数値は、–2,147,483,648から2,147,483,647までの範囲に含まれ、空のセルは含まれていません。                                                                                                                                                             | 整数                                                             |
| 種類のデータ –9,223,372,036,854,775,808~9,223,372,036,854,775,807の範囲に該当し、空のセルは含まれません。                                                                                                                                                        | 長い順                                                            |
| Integer および Long 属性型の条件に該当しないその他の数値では、列に空のセルが含まれていません。                                                                                                                                                                                 | 小数点以下桁数                                                        |
| 日付と時刻                                                                                                                                                                                                                                  | 日付と時間<br />**注** もし日付のみがプレビューの時刻に設定されている場合は、 00:00 になります |
| 列は enumeration 属性型のエンティティに変換され、次の条件が満たされています。 <br /><ul><li>値は文字列として識別されます</li><li>列の値は複数回使用されます</li><li>この値の数が10以下または等しいです</li></ul>上記のすべての条件が満たされると、列は列挙として扱われ、値は列挙項目に変換されます。 小文字または大文字の綴り以外の値は、最も一般的なバージョンで結合されます。 すべての値が同じ回数で使用されている場合、最初の値の下に表示されます。 例えば、値 "Test" と "test" が結合されます。 | 列挙型                                                            |
### 4.2 データのインポート

すべてのデータを確認したら、 **Data Preview** 画面の下部にある **Import Data** をクリックします。

ファイルがどのように変換されたかを簡単なツアーでご案内できます。

ドメインモデルを開いて、作成されたすべてのエンティティと属性を表示します。

{{% image_container width="350" %}}![](attachments/start-with-data/domain-model-example.png)
{{% /image_container %}}

{{% alert type="success" %}}

インポートが完了したら、 [アプリをプレビューまたは公開](publishing-app) し、すべてのデータを表示するか、アプリの設定を続けることができます。

{{% /alert %}}

### 4.3 ページの生成 {#generating-pages}

**自分のデータ** のページを生成するformat@@2 がプレビューページで選択されている場合、ページはスプレッドシートに基づいて作成されます。 ページエディタとナビゲーションドキュメントに以下の変更が加えられます。

* *Manage_Data* ページが作成されます - 各Excelテーブルのタブと各エンティティごとのデータグリッドを備えた概要ページ

    ![](attachments/start-with-data/manage-data-page.png)

* *{EntityName}__NewEdit* ページが作成されます – このエンティティの新しいオブジェクトを作成および保存するための各エンティティのページ

* *HomePage* からのリンクが作成されます - *Manage_Data* ページにリンクされているボタンのあるカード

    ![](attachments/start-with-data/home-page.png)

* *Manage Data* menu item is created in the navigation with a link to the *Manage_Data* page

* データはプレビューに転送され、公開されます。つまり、アプリをプレビューまたは公開するときに、そこにデータを表示できます。

## 5 続きを読む

* [ドメインモデル](domain-models)
* [属性タイプ](domain-models-attributes) 
