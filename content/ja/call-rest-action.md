---
title: "REST サービスアクションを呼び出す"
parent: "microflow activities"
---

{{% alert type="info" %}}
この活性は、ナノフローではなく、マイクロフローでのみ使用できます。
{{% /alert %}}

## 1つの紹介

REST サービスを呼び出すアクションは、REST エンドポイントを呼び出すために使用できます。 REST コールの応答をどのように処理するか、場所を指定できます。

## 2つの全般

![](attachments/19203256/19399080.png)

### 2.1 ロケーション

**Location** プロパティで、呼び出される REST エンドポイントを定義します。 場所は文字列テンプレートを使用して入力する必要があります。 文字列テンプレートは有効な URL 文字列になります。 パラメータは、括弧間の数値を書くことで使用できます(例: `{1}`)。 テンプレート内の各パラメータに対して、文字列値を生成する [マイクロフロー式](expressions) を使用してその値を指定できます。 オープニングブレースをエスケープするには (`{`), ダブルオープンブレースを使用する必要があります (`{{`).

**HTTP メソッド** プロパティは、REST エンドポイントを呼び出すときに使用する HTTP メソッドを定義します。 GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS.

### 2.2 タイムアウト

**リクエスト時のタイムアウトを** に **はい** に設定して、コールRESTのエンドポイントが応答するのを待つ時間を指定できます。 もし REST エンドポイントが **タイムアウト (s)**の秒数の後に応答していない場合 例外が発生し、microflow がロールバックまたはカスタムエラーハンドラに移動します。

### 2.3 プロキシ設定

{{% alert type="info" %}}

この機能はバージョン7.15.0で導入されました。

{{% /alert %}}

ほとんどの場合、この設定は無視できます。 **プロジェクト設定を使用する** は良いデフォルト値です。

必要に応じて、リクエストにプロキシを使用するかどうかを設定できます。 選択肢は以下の通りです:

* **プロジェクト設定を使用する** – プロジェクトレベルで定義されているすべての設定を使用する (デフォルト)
* **オーバーライド** – このアクションのプロジェクトレベルの設定を上書きする
* **プロキシなし** – このアクションにプロキシを使用しないでください

**Override**を選択すると、プロキシを使用するかどうかを動的に設定できます。 その後、プロキシのホスト、ポート、ユーザー名、およびパスワードの設定を指定します。

## 3 HTTP ヘッダー

![](attachments/19203256/19399093.png)

### 3.1 認証

**HTTP 認証を使用する** チェック ボックスは、基本認証を使用するかどうかを定義します。

**User name** プロパティは、HTTP を介した認証に使用されるユーザー名を定義します。 ユーザー名は [microflow Expressions](expressions) を使用して入力する必要があります。 microflow 式は文字列になります。

**Password** プロパティは、HTTP を介した認証に使用されるパスワードを定義します。 パスワードは [式](expressions) を使用して入力する必要があります。 microflow 式は文字列になります。

### 3.2 カスタム HTTP ヘッダー

これらのヘッダは HTTP リクエストヘッダに追加されます。 各カスタムヘッダーは、キーと値(マイクロフロー式)のペアです。

## 4つのリクエスト

![](attachments/19203256/19399114.png)

以下のセクションでは、リクエストを生成するためのドロップダウンメニューのオプションについて説明します。 リクエストは HTTP メソッド POST、PUT、PATCH、および OPTIONS に対してのみ生成できます。

### 4.1 リクエスト全体のエクスポートマッピング

このオプションを使用すると、リクエストの本文に単一の [エクスポート マッピング](export-mappings) を使用できます。

#### 4.1.1 マッピング

適用するマッピングを選択します。

#### 4.1.2 パラメータタイプ

[エクスポート マッピング](export-mappings) が入力を必要とする場合、このフィールドは入力の型を表示します。

#### 4.1.3 パラメータ

[エクスポート マッピング](export-mappings) が入力を必要とする場合、正しい型の変数を選択することができます。

#### 4.1.4 コンテンツタイプ

[エクスポート マッピング](export-mappings) がメッセージ定義に基づいている場合、XML と JSON の両方をエクスポートすることができます。 必要な出力タイプを選択します。 **Content-Type ヘッダー** がデフォルトでは設定されていません。 設定するには、 **Custom HTTP Headers** タブを使用します。

### 4.2 リクエスト全体のバイナリ

このオプションを使用すると、バイナリデータ(例えば、FileDocumentの内容)を送信できます。

### 4.3 カスタムリクエストテンプレート

このオプションを使用すると、文字列テンプレートを使用して要求を生成できます。 テンプレートはプレーンテキストでリクエストの構造を定義します。 パラメータは、括弧間の数値を書くことで使用できます(例: `{1}`)。 テンプレート内の各パラメータに対して、文字列値を生成する [マイクロフロー式](expressions) を使用してその値を指定できます。 オープニングブレースをエスケープするには (`{`), ダブルオープンブレースを使用する必要があります (`{{`).

## 5つの回答

![](attachments/19203256/19399084.png)

### 5.1 応答処理

これらは、応答を処理するためのドロップダウンメニューのオプションです。

* **Apply import mapping** – if the response is JSON or XML, it can be transformed directly into objects using an [import mapping](import-mappings). ここで選択できるフィールドは、 [マッピングのインポート](import-mapping-action) に記載されています。
* **Store in an HTTP response** – any successful HTTP response can be stored directly in an [HttpResponse](http-request-and-response-entities#http-response) object, and the [$latestHttpResponse](#latesthttpresponse) variable is also updated
* **Store in a file document variable** – if the response is a binary content (for example, a PDF), it can be stored in an entity – this entity should inherit from `System.FileDocument`
* **文字列に保存** – 応答が文字列の場合 (CSVなど)、文字列変数に直接格納することができます。
* **変数に格納しないでください** - 呼び出しが役に立つものを返さない場合、このオプションを使用してください

### 5.2 出力

**Type** フィールドで、出力変数の型が定義されます。

**Name** フィールドは、操作の結果を保持する変数の名前を定義します。

### 5.3 エラー処理

このセクションは、HTTP レスポンスステータスコードが失敗した場合に適用されます(例えば、リダイレクション [3xx] や エラー [4xx と 5xx])。

**メッセージ本文を $latestHttpResponse 変数** に保存するオプションが選択されると、 `$latestHttpResponse/Content` は応答本文に設定されます。 サーバーによって提供される有用な情報(たとえば、認証が拒否される理由など)が含まれている可能性があります。

### 5.4 $latestHttpResponse 変数<a name="latesthttpresponse"></a>

`$latestHttpResponse` 変数は [HttpResponse](http-request-and-response-entities#http-response) 型です。 コールRESTアクティビティの後に利用できます。

しかし、その `Content` 属性はほとんどの場合、メモリ使用量を最小限に抑えるために空のままになります。

この属性は、次のシナリオのいずれかが発生した場合に表示されます。

* **レスポンス処理** は **HTTP 応答** に格納され、成功しました。
* **メッセージ本文を $latestHttpResponse 変数** オプションの **エラー処理** にチェックし、呼び出しに失敗しました。

この変数は、スコープ内の任意のマイクロフローアクションからアクセスできます。
