---
title: "Nanoflows"
parent: "application-logic"
menu_order: 20
description: "ナノフローで使用できるすべての要素の概要を示します。"
---

## 1つの紹介

{{% alert type="info" %}}

このページは、ナノレベルで使用できるすべての要素の概要です。 nanoflow 自体のプロパティについては、 [Nanoflow Properties](nanoflow) を参照してください。

{{% /alert %}}

Nanoflows は [microflow](microflows)に似ており、アプリケーションのロジックを表すことができます。 ただし、特定の利点があります(例えば、ブラウザー/デバイス上で直接実行され、オフラインアプリで使用できます)。 さらに、ほとんどのアクションはデバイス上で直接実行されるため、速度の利点もあります。

## 2 ナノフローを使用する場合

### 2.1 オフラインモバイルアプリ

Nanoflowはオフラインアプリケーションで動作するアプリケーションロジックをモデル化できるため、オフラインファーストのアプリケーションを念頭に置いて設計されています。 データベースに関連するすべてのアクションはローカルオフラインデータベース上で実行されるため、オフラインアプリのナノフローは超高速になります。

### 2.2 接続が不要な場所のLogic

Nanoflowは、オンラインアプリケーション(例えば、UIロジック、検証、計算、ナビゲーションなど)でも大きな価値を提供します。 ただし、データベース関連のアクションを実行すると、各アクションは Mendix Runtime に個別のネットワーク要求を作成することに注意してください。 次のアクションはデータベースと相互作用します:

* 作成
* コミット
* 保留する
* Rollback

したがって、ベストプラクティスは、上記のアクションを含まない場合、オンラインアプリケーションでナノフローを使用することです。

{{% alert type="info" %}}
変更がデバイスやブラウザに適用されるため、コミットせずにオブジェクトを変更することはデータベース関連のアクションではありません。
{{% /alert %}}

### 2.3 その他のケース

前の節では、データベースに関連するアクションが使用されていない場合、nanoflowはオンラインアプリケーションで最も効果的であると述べており、これらは一般的に最善のケースです。 しかし、最大で1つのデータベース関連のアクションを含むナノフローは、まだうまく機能することができます。 このようなナノフローはネットワーク呼び出しを1回だけ必要とするため、マイクロフローと同様に機能します。 このようなユースケースの例として、あるオブジェクトに対してバリデーションロジックを実行し、同じナノフロー内のオブジェクトをコミットすることがあります。

## マイクロフローと3つの違い

主に3つの違いがあります。

* アクションを通じてナノフローのステップを実行すると、クライアントアクションは直接実行されます。 たとえば、開いているページアクションは、ナノフローの終わりではなく、直ちにページを開きます。 これは、マイクロフロー内のクライアントアクションとは異なり、クライアントがマイクロフローから結果を受信したときにのみ実行されます。
* When used in nanoflow activities, expressions do not support the following variables: `$latestError`, `$latestSoapFault`, `$latestHttpResponse`, `$currentSession`, `$currentUser`, `$currentDeviceType`.
* Nanoflows はトランザクション内で実行されないため、nanoflow でエラーが発生した場合、以前の変更はロールバックされません。

## 4つのキーボードサポート

nanoflowエディタは、ナノフローのナビゲートと操作のためのキーボードサポートを提供します。 次の表は、使用可能なキーを示しています。

| キーワード                                             | 効果                                             |
| ------------------------------------------------- | ---------------------------------------------- |
| 矢印キー                                              | 近くの要素(アクティビティ、イベント、ループ、またはパラメーター)を矢印の方向に選択します。 |
| <kbd>Enter</kbd>                                  | 選択した要素のプロパティを編集します。                            |
| <kbd>F2</kbd>                                     | 選択した要素によって導入された変数の名前を変更します。                    |
| <kbd>Shift</kbd> + <kbd>F2</kbd> または入力を開始しました     | 選択した要素のキャプションを編集します。                           |
| <kbd>Ctrl</kbd> + 矢印キー                            | 選択した要素を矢印の方向に移動します。                            |
| <kbd>Tab</kbd>                                    | ループが選択されている場合、ループ内の最初の要素が選択されます。               |
| <kbd>Shift</kbd> + <kbd>Tab</kbd>                 | ループ内の要素が選択されている場合、ループ自体が選択されます。                |
| <kbd>ホーム</kbd>                                    | 開始イベントを選択します。                                  |
| <kbd>終了</kbd>                                     | 終了イベントをサイクルします。                                |
| コンテキストメニューキーまたは <kbd>Shift</kbd> + <kbd>F10</kbd> | 現在選択されている要素のコンテキストメニューを開きます。                   |

## 5種類の表記とカテゴリ

ナノフローのグラフィカル表記は、 [Business Process Model and Notation](https://en.wikipedia.org/wiki/Business_Process_Model_and_Notation) (BPMN) に基づいています。 BPMN は、ビジネスプロセスをワークフローで描画するための標準化されたグラフィカル表記です。

ナノフローは元素で構成されています。 以下のカテゴリが使用されます：

* [イベント](#events) はループにおけるナノフローおよび特殊演算の開始点と終了点を表します
* [フロー](#flows) が要素間の接続を形成します
* [ゲートウェイ](#gateways) は、選択を行い、異なるパスを再びマージすることに対処します。
* [アクティビティ](#activities) はナノレベルで実行されるアクションです
* [アーティファクト](#artifacts) は入力とともにナノフローを提供し、コメントを作成できるようにする

### 5.1 イベント<a name="events"></a>

イベントは、ループ内のナノおよび特殊な操作の開始点と終了点を表します。

| グラフィック                                               | 名前                         | 説明                                                                                      |
| ---------------------------------------------------- | -------------------------- | --------------------------------------------------------------------------------------- |
| [![](attachments/819203/917902.png)](start-event)    | [イベントを開始](start-event)     | ナノフローの出発点。 ナノフローは、1つの開始イベントしかありません。                                                     |
| [![](attachments/819203/918113.png)](end-event)      | [イベントを終了](end-event)       | ナノフローが停止する位置を指定します。 nanoflow の戻り値の型に応じて、値を指定する必要があります。 複数のエンドイベントが存在する可能性があります。         |
| [![](attachments/819203/918115.png)](continue-event) | [イベントを続ける](continue-event) | ループの現在の反復を停止し、次の反復を続けるために使用します。 継続イベントは [ループ](loop)内でのみ使用できますのでご注意ください。                 |
| [![](attachments/819203/918026.png)](break-event)    | [休憩イベント](break-event)      | オブジェクトのリストの反復を停止し、ループの後の残りのフローを継続するために使用されます。 ブレークイベントは [ループ](loop)内でのみ使用できますのでご注意ください。 |

### 5.2 フロー<a name="flows"></a>

フローは要素間の接続を形成します。

| グラフィック                                                | 名前                        | 説明                                                      |
| ----------------------------------------------------- | ------------------------- | ------------------------------------------------------- |
| [![](attachments/819203/917883.png)](sequence-flow)   | [シーケンスフロー](sequence-flow) | イベント、アクティビティ、分割、および互いに結合する矢印。 彼らは一緒に、1ナノ以内の実行の順序を定義します。 |
| [![](attachments/819203/917688.png)](annotation-flow) | [注釈フロー](annotation-flow)  | 注釈を別の要素に接続するために使用できる接続。                                 |

### 5.3 ゲート<a name="gateways"></a>

ゲートウェイは選択肢を作ることと異なるパスをマージすることに対処します。

| グラフィック                                                | 名前                        | 説明                                                                                                      |
| ----------------------------------------------------- | ------------------------- | ------------------------------------------------------------------------------------------------------- |
| [![](attachments/819203/917726.png)](exclusive-split) | [排他的な分割](exclusive-split) | 条件に基づいて決定を行い、唯一の発信フローをフォローします。 ナノフローでは並列実行は行われませんのでご注意ください。                                             |
| [![](attachments/819203/918116.png)](マージ)             | [結合](マージ)                 | 複数のシーケンスフローを1つに結合するために使用できます。 選択がナノの中で行われ、その後、いくつかの一般的な作業が行われる必要がある場合。 マージを使用して、2 つのパス(またはそれ以上)を結合できます。 |

### 5.4 アクティビティ<a name="activities"></a>

アクティビティは、ナノレベルで実行されるアクションです。

#### 5.4.1 オブジェクトの動作

オブジェクトのアクティビティはオブジェクトの作成や操作に使用できます。 [ドメイン モデル](domain-model) は、使用可能なオブジェクト タイプ ([エンティティ](entities)) を定義します。

| グラフィック                                                       | 名前                               | 説明                                                                                                            |
| ------------------------------------------------------------ | -------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| [![](attachments/819203/917661.png)](change-object)          | [オブジェクトの変更](change-object)       | オブジェクトのメンバーを変更するために使用できます。 これはコミットの有無に関わらず行うことができます。                                                          |
| [![](attachments/16713769/17661961.png)](committing-objects) | [コミットオブジェクト](committing-objects) | 1つ以上のオブジェクトに変更をコミットするために使用できます。                                                                               |
| [![](attachments/819203/917756.png)](create-object)          | [オブジェクトを作成](create-object)       | オブジェクトの作成に使用できます。                                                                                             |
| [![](attachments/819203/917866.png)](retrieve)               | [保留する](retrieve)                 | 別のオブジェクトの 1 つ(または複数) 関連するオブジェクトを取得するために使用できます。 アクティビティは、データベースから直接オブジェクトを取得することもできます (またはそれ以上)。               |
| [![](attachments/819203/918119.png)](rollback-object)        | [オブジェクトのロールバック](rollback-object) | アクティビティの先頭にある nanoflow の部分でオブジェクトに加えられた (コミットされていない) 変更を元に戻すために使用できます。 これは、作成されたことがないがコミットされていないオブジェクトも削除します。 |

#### 5.4.2 リストアクティビティ

リストアクティビティは、オブジェクトのリストの作成と操作に使用できます。

| グラフィック                                            | 名前                    | 説明                        |
| ------------------------------------------------- | --------------------- | ------------------------- |
| [![](attachments/819203/918007.png)](change-list) | [リストの変更](change-list) | リスト変数の内容を変更するために使用できます。   |
| [![](attachments/819203/918009.png)](create-list) | [リストを作成](create-list) | (空の) リスト変数を作成するために使用できます。 |

#### 5.4.3 可変アクティビティ

変数アクティビティは、マイクロフロー内で変数を作成または変更するために使用できます。

| グラフィック                                                | 名前                       | 説明                   |
| ----------------------------------------------------- | ------------------------ | -------------------- |
| [![](attachments/819203/918011.png)](change-variable) | [変数の変更](change-variable) | 変数の値を変更するために使用できます。  |
| [![](attachments/819203/918110.png)](create-variable) | [変数を作成](create-variable) | 新しい変数を作成するために使用できます。 |

#### 5.4.4 クライアントアクティビティ

クライアントアクティビティは、アプリケーションのWebクライアントにアクションを実行させるために使用できます。 例えば、別のページを表示したり、ファイルをダウンロードしたりしています。

| グラフィック                                                    | 名前                                | 説明                                                   |
| --------------------------------------------------------- | --------------------------------- | ---------------------------------------------------- |
| [![](attachments/819203/918114.png)](close-page)          | [ページを閉じる](close-page)             | このアクティビティが使用されているマイクロフローを呼び出すユーザーが最後に開いたページを閉じます。    |
| [![](attachments/819203/917544.png)](show-page)           | [ページを表示](show-page)               | このアクティビティが使用されているマイクロフローを呼び出すユーザーにページを表示するために使用できます。 |
| [![](attachments/819203/918097.png)](validation-feedback) | [検証のフィードバック](validation-feedback) | 属性や関連付けを表示するウィジェットの下に赤色のテキストを表示するために使用できます。          |

### 5.5 ループ

| グラフィック                                    | 名前         | 説明                                                                                                                                                                       |
| ----------------------------------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [![](attachments/819203/917804.png)](ループ) | [ループ](ループ) | ループされたアクティビティは、オブジェクトのリストを繰り返すために使用されます。 オブジェクトごとに、ループされたアクティビティ内のフローが実行されます。 ループされたアクティビティには、開始および停止イベントを除き、ナノフローで使用されるすべての要素を含めることができます。 フローは、最初の要素から開始され、フローは入力されません。 |

### 5.6 アーティファクト<a name="artifacts"></a>

アーティファクトはナノフローに入力を提供し、コメントを作成することができます。

| グラフィック                                         | 名前             | 説明                                                    |
| ---------------------------------------------- | -------------- | ----------------------------------------------------- |
| [![](attachments/819203/918019.png)](パラメータ)    | [パラメータ](パラメータ) | ナノフローの入力として機能するデータ。 パラメータは、nanoflowがトリガーされる位置に入力されます。 |
| [![](attachments/819203/917689.png)](アノテーション:) | [注釈](アノテーション:) | コメントを入れるために使用できる要素。                                   |

## 6種類の変数の使用

モデラーは、選択したオブジェクトによって使用される変数を視覚化します。 これは、使用されている変数を青色の背景に白のテキストで表示することによって行います。 逆に 選択されたオブジェクトによって定義された変数を使用する要素は、緑色の背景に白いテキストで **使用** という単語でマークされます。

以下の例では、選択したアクティビティで使用されているため、パラメータ **AccountPasswordData** がハイライトされます。 そして、アクティビティ **パスワードを保存** には、選択したアクティビティによって定義された変数を使用するための使用ラベルがあります。

![](attachments/16713739/16843950.png)

## 7 エラー

nanoflow でエラーが発生した場合、オブジェクトに加えられたすべての変更はロールバックされず、nanoflow は中断されます。 Nanoflowアクションはエラーハンドラをサポートしていません。

## 8 Nanoflow デバッグ

ステップバイステップのデバッグはまだサポートされていません。 現時点では、Desktop Modelerのコンソールログ(バージョン7.13.0以降)に表示されるログメッセージアクションを使用することをお勧めします。

## 9 セキュリティ

Nanoflows は、現在のユーザーのコンテキストで実行されます。 ユーザーが許可されていない操作はすべて失敗します。 例えば、オブジェクトが nanoflow で取得された場合、現在のユーザが読み込みアクセス権を持つオブジェクトのみが返されます。 オブジェクトをコミットすることは、現在のユーザーがすべての変更に対して書き込みアクセス権を持っている場合にのみ成功します。
