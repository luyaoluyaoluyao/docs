---
title: "マッピングをインポート"
parent: "mapping-documents"
---

紹介については、 [マッピングドキュメント](mapping-documents) を参照してください。

## 1 マッピングをインポートしてオブジェクトを取得する

Figure 1 depicts an example of an Import Mapping document in which two elements from an XML Schema have been selected using the **Select elements...** dialog. これに続いて、ReceivedPartnersとReceivedClientエンティティが追加され、結果とクライアントスキーマ要素にマッピングされました。 インポートマッピングが呼び出されるたびに、新しいReceivedPartnersオブジェクトが作成されます。

![](attachments/16713727/16843942.png)

**図 1**

### 1.1 オブジェクトの取得

XML または JSON オブジェクトごとに、Mendix オブジェクトを取得する必要があります。 作成するか、データベース内に存在するオブジェクトを見つけることができます。 あるいは、オブジェクトを返すカスタムマイクロフローを使用することもできます。 図2に示すウィンドウでMendixオブジェクトがどのように取得されているかを見ることができます。 これは特定のマッピング要素をダブルクリックすると表示されます。

![](attachments/16713727/16843943.png)

**図 2**

### 1.2 属性マッピングのプロパティ

#### 1.2.1 Mendix オブジェクトメソッドの取得

| 属性                  | 説明                                                                                                                                                                     |
| ------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **オブジェクトを作成**       | 単に新しいオブジェクトを作成します。 失敗するマイクロフローを作成する前に、エラーが発生する可能性があります。                                                                                                                |
| **オブジェクトを検索 (キーで)** | 属性リストで定義されているキーを使用してオブジェクトを検索します。 ランタイムは、 **キー** としてマークされたすべての属性 (下記の **値要素でマッピングする** セクション) を使用してオブジェクトを検索し、XPath クエリに変換します。 XPath クエリにより複数のオブジェクトが返されると、エラーがスローされます。 |
| **マイクロフローを呼び出す**    | オブジェクトを取得するためにマイクロフローを呼び出します。 マイクロフローがパラメータを期待する場合、これらは **Select...** ウィンドウで指定する必要があります。 可能なパラメーターは入力パラメーター(上記参照)であり、マッピング内の親エンティティであり、もちろん現在の XML 要素内の属性です。           |

#### 1.2.2 オブジェクトが見つからなかった場合

これは、指定された **オブジェクト** アクションを取得するためにエラーが発生したときにランタイムが実行するアクションです。

| 属性      | 説明                                                          |
| ------- | ----------------------------------------------------------- |
| **作成**  | マップするドメインエンティティを作成する。                                       |
| **無視**  | この要素をマッピングし、残りの XML の解析を続行しないでください。                         |
| **エラー** | XML の解析を明示的に中止し、エラーを投げます。 このエラーは、呼び出し元のマイクロフローで処理する必要があります。 |

{{% alert type="info" %}}

機能 **バージョン 7.17.0 でマッピングが使用される場所でこれを決定する**

{{% /alert %}}

マッピングのトップレベルでは、マッピングが使用される場所でこれを決定することができます。 In that case, the option **if no object was found** shows up whenever you use the mapping, for instance in an [import mapping action](import-mapping-action) or a [call REST service action](call-rest-action).

### 1.3 関連を設定

オプションで、関連付けを親オブジェクトに設定できます。 「はい」に設定した場合、許可された関連付けのリストが表示されます。 関連付けが選択されると、マッピングドキュメント内に描画されます。

{{% alert type="warning" %}}

リストは Mendix データベースに保存されていないことに注意してください。 XML スキーマは、オブジェクトのグループ化はシーケンスであることを規定することができます。 しかし、データベース内の Mendix オブジェクトの順序は、受信する XML 要素の順序と異なる場合があります。

{{% /alert %}}

## インポートマッピングでのマッピング属性 2

選択された XML または JSON 要素は、ドメインエンティティ内の属性にマップされる必要があります。 特定の要素をマッピングしたくない場合は、 **要素を選択...** ダイアログボックスでチェックを外してください。 属性をマップする方法を設定することは、特定のマッピング要素をダブルクリックした後に表示される図3に示されている画面で行われます。

![](attachments/16713727/16843943.png)

**図 3**

属性のマッピングを定義した場合、これらのマッピングはマッピングドキュメントにも表示されます。 特定の属性が選択されると、スキーマ要素も選択されます。 これは他の方法でも動作します。 An example of this is shown in figure 4, where the **dati** attribute is selected in both the Entity and the schema element (in this case dati is mapped to dati).

![](attachments/16713727/16843944.png)

**図 4**

### 2.1 属性のプロパティ

| 属性             | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| エンティティ属性       | ここでは、この値要素をマップする属性を選択できます。 各値マッピングは、オブジェクトを取得するためにマイクロフロー内のパラメータとして使用される場合を除き、マッピングする必要があります。                                                                                                                                                                                                                                                                                                                                                            |
| スキーマ値要素        | スキーマ値要素の名前と型。                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| オカレンスformat@@0 | 要素が発生する頻度を反映します。 これは、必要とされるかどうかに応じて、 **0..1** または **1**にすることができます。 値が空で、要素の最小要素が(スキーマによって指定されているように)0の場合、要素の作成はスキップされます。 オプションの要素に値をマッピングしない場合は、 **要素の選択...** ダイアログで値を無効にするだけです。                                                                                                                                                                                                                                                                         |
| 変換方法 (任意)      | 値要素の受信データが正しい形式でない場合、 マイクロフローを使って別のデータ型に変換できます 変換マイクロフローは、要素の型に一致するパラメータを持つ必要があります。 あるいは、すべての受信データが文字列であるため、パラメータは String 型であることもあります。 たとえば、受信データにエキゾチックなDateTime形式が含まれている場合です。 Stringパラメータを使用した変換マイクロフローを使用して、この形式を自分で解析できます。 この値要素が属性にマップされる場合、変換マイクロフローの戻り値の型は属性の型と一致しなければなりません。 これらの値要素の変換マイクロフローは、オブジェクトを取得するための検索キーやマイクロフローパラメータとして使用される前に実行されます。 つまり、変換マイクロフローを持つ値要素をオブジェクトを取得するためにマイクロフローのパラメータとして使用する場合です。 パラメータ型は、変換マイクロフローの戻り値の型と一致する必要があります。 |
| キー             | このプロパティは、オブジェクトを取得する検索キーとしてvalue要素を使用するかどうかを指定します。 value 要素が検索キーとして使用される場合は、マップする属性を指定する必要があります。 XML の値は、オブジェクトを検索する際にこの属性の値と一致します。 'binary' 型の属性はキーとして設定できません。                                                                                                                                                                                                                                                                                          |
| 属性を名前でマップする    | このボタンをクリックすると、名前で属性を一致させようとします。 変更内容を報告するダイアログが表示されます。                                                                                                                                                                                                                                                                                                                                                                                                   |

## 3 マッピングパラメータ

{{% alert type="info" %}}

バージョン7.16.0から。 プリミティブデータ型(整数、文字列など)を持つマッピングパラメータを定義することができます。

{{% /alert %}}

インポートマッピングには、受信パラメータを受け取るための追加オプションがあります。 このパラメータは、microflow が [import from mapping](import-mapping-action) アクションを使用する場合に、呼び出し元の microflow によって渡すことができます。

マッピングのパラメーターを定義するには、パラメーターボックスをクリックしてデータ型を選択します。 パラメータボックスに図形をドラッグすることもできます。

パラメータをキーとして、またはマイクロフロー内でオブジェクトを取得することができます。 entity パラメータを使用する場合、関連付けを設定できます。 プリミティブなパラメーター (string, integer など) を使用すると、インポートされるオブジェクトの属性に値を書き込むことができます。
